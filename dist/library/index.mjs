import t from"@swc/helpers/src/_define_property.mjs";import"core-js/modules/es.promise.finally.js";import"core-js/modules/web.dom-collections.iterator.js";import e,{JSONSchemaType as n}from"ajv";import{ResizeObserver as i}from"@juggle/resize-observer";function a(t){return t&&t.__esModule?t.default:t}function o(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var r=class{buildExecutor(t){const e=this.unpack(t);return()=>this.execute(e)}constructor(e){t(this,"state",void 0),this.state=e}};function s(t){throw new TypeError("This function should never be called. If it has been called, your type narrowing is incomplete.")}const c=new e;function l(t,e){return n=void 0===e?c.compile(t):c.compile(t,e),(t,e)=>{if(void 0===e){if(n(t))return t}else if(n(t))return t;throw new TypeError(JSON.stringify(n.errors))};var n}const m=l({type:"array",items:{type:"object",properties:{mimetype:{type:"string"},url:{type:"string"}},required:["mimetype","url"]}});var d,p,u=class extends r{async execute(t){const{preloader:e}=this.state;return e.clear(),await Promise.resolve(),e.preload(...t)}unpack(t){return m(t)}constructor(t){super(t)}};(p=d||(d={}))[p.OFF=0]="OFF",p[p.ERROR=200]="ERROR",p[p.WARN=300]="WARN",p[p.INFO=400]="INFO",p[p.DEBUG=500]="DEBUG",p[p.TRACE=600]="TRACE";class h{error(...t){this.level>=d.ERROR&&console.error(...t)}assert(t,...e){this.level>=d.ERROR&&console.assert(t,...e)}warn(...t){this.level>=d.WARN&&console.warn(...t)}info(...t){this.level>=d.INFO&&console.info(...t)}debug(...t){this.level>=d.DEBUG&&console.debug(...t)}trace(...t){this.level>=d.TRACE&&console.trace(...t)}constructor(e=d.INFO){t(this,"level",void 0),this.level=e}}var y=class extends r{async execute(){return window.location.reload(),Promise.resolve()}unpack(){}constructor(t){super(t)}};class v{promise(){return this._promise}resolve(t){return this._resolve(t)}reject(){return this._reject()}constructor(){t(this,"_promise",void 0),t(this,"_resolve",void 0),t(this,"_reject",void 0);let e=()=>{},n=()=>{};this._promise=new Promise(((t,i)=>{e=t,n=i})),this._resolve=e,this._reject=n}}async function f(t,e,n){return new Promise(((i,a)=>{const[o,r]=[()=>{e.forEach((e=>t.removeEventListener(e,o))),n.forEach((e=>t.removeEventListener(e,r))),i(t)},i=>{e.forEach((e=>t.removeEventListener(e,o))),n.forEach((e=>t.removeEventListener(e,r))),a(i)}];e.forEach((e=>t.addEventListener(e,o))),n.forEach((e=>t.addEventListener(e,r)))}))}class g{static key(t,e){return`{${t}}{${e}}`}preloadImpl(t,e){const n=g.key(t,e),i=g.createPreloadingElement.bind(g);var a;const o=null!==(a=this.refs.get(n))&&void 0!==a?a:i(t,e);return this.container.appendChild(o),this.refs.set(n,o),{key:n,element:o}}preload(...t){return t.map((({mimetype:t,url:e})=>this.preloadImpl(t,e))).map((({element:t})=>g.readyForDisplay(t).then()))}get(t,e){const{key:n,element:i}=this.preloadImpl(t,e);i.remove();const a=i.cloneNode(!0);return this.container.appendChild(a),this.refs.set(n,a),i}static async readyForDisplay(t){return t instanceof HTMLImageElement?await g.readyForDisplayImage(t):t instanceof HTMLVideoElement?await g.readyForDisplayVideo(t):s(),t}static async readyForDisplayImage(t){return t.complete||await f(t,["load"],["abort","error"]),t}static async readyForDisplayVideo(t){return t.readyState<HTMLMediaElement.HAVE_ENOUGH_DATA&&await f(t,["canplaythrough"],["abort","error"]),t}static createPreloadingElement(t,e){const n=t.split("/",1)[0];switch(n){case"image":return g.createPreloadingImage(e);case"video":return g.createPreloadingVideo(e);default:throw new TypeError(`Unsupported MIME type: ${n} (${t})`)}}static createPreloadingImage(t){const{href:e}=new URL(t),n=new Image;return n.src=e,n}static createPreloadingVideo(t){const e=document.createElement("video");return e.preload="auto",e.src=t,e.autoplay=!1,e}unrefImpl(...t){t.forEach((t=>{const e=this.refs.get(t);null==e||e.remove(),this.refs.delete(t)}))}unref(...t){const e=t.map((({mimetype:t,url:e})=>g.key(t,e)));this.unrefImpl(...e)}clear(){this.unrefImpl(...this.refs.keys())}constructor(e=document.createElement("div")){t(this,"container",void 0),t(this,"refs",new Map),this.container=e}}var w=g;class b{static create(t,e,n=new w){return n.get(t,e)}static play(t){return t instanceof HTMLImageElement?t:t instanceof HTMLVideoElement?(t.play().finally((()=>{})),t):s()}static setVolume(t,e,n){if(t instanceof HTMLImageElement)return t;if(t instanceof HTMLVideoElement){switch(n){case"absolute":t.volume=Math.min(1,Math.max(e,0));break;case"relative":t.volume=Math.min(1,Math.max(t.volume*e,0));break;default:s()}return t}return s()}static setMuted(t,e){return t instanceof HTMLImageElement?t:t instanceof HTMLVideoElement?(t.muted=e,t):s()}static async getDimensions(t){return t instanceof HTMLImageElement?b.getDimensionsImage(t):t instanceof HTMLVideoElement?b.getDimensionsVideo(t):s()}static async getDimensionsImage(t){return t.complete||await f(t,["load"],["abort","error"]),{width:t.naturalWidth,height:t.naturalHeight}}static async getDimensionsVideo(t){return t.readyState<HTMLMediaElement.HAVE_METADATA&&await f(t,["loadedmetadata"],["abort","error"]),{width:t.videoWidth,height:t.videoHeight}}}var E=b;const k=window.ResizeObserver||i;class z{update(){const t=z.elementSizes.get(this.content);if(void 0===t)return;const e=z.elementSizes.get(this.container);if(void 0===e)return;e.width/e.height>t.width/t.height?(this.container.style.setProperty("--fit-cover-max-width","100%"),this.container.style.setProperty("--fit-cover-max-height","auto"),this.container.style.setProperty("--fit-contain-min-width","auto"),this.container.style.setProperty("--fit-contain-min-height","100%")):(this.container.style.setProperty("--fit-cover-max-width","100%"),this.container.style.setProperty("--fit-cover-max-height","auto"),this.container.style.setProperty("--fit-contain-min-width","100%"),this.container.style.setProperty("--fit-contain-min-height","auto"))}static register(t,e){const n=new z(t,e);return z.addInstance(t,n),z.addInstance(e,n),z.resizeObserver.observe(t),E.getDimensions(e).then((t=>{z.elementSizes.set(e,t),n.update()})).catch((t=>{console.error("Could not retrieve size of content element.",e,t,"Content fitting will most likely not work for this element.")})),n}static unregister(t){const{container:e,content:n}=t;z.removeInstance(e,t),z.removeInstance(n,t)}static addInstance(t,e){const n=z.getInstances(t);n.push(e),z.fitUpdaterInstances.set(t,n)}static removeInstance(t,e){const n=z.getInstances(t),i=n.indexOf(e);-1!==i&&z.fitUpdaterInstances.set(t,n.splice(i,1))}static getInstances(t){const e=z.fitUpdaterInstances.get(t);return void 0===e?[]:[...e]}static resizeObserverCallback(t){t.filter((({target:t})=>t instanceof HTMLElement)).forEach((({target:t,contentRect:{width:e,height:n}})=>{const i=t;z.elementSizes.set(i,{width:e,height:n}),z.getInstances(i).forEach((t=>t.update()))}))}constructor(e,n){t(this,"container",void 0),t(this,"content",void 0),this.container=e,this.content=n}}t(z,"resizeObserver",new k(z.resizeObserverCallback.bind(z))),t(z,"elementSizes",new WeakMap),t(z,"fitUpdaterInstances",new WeakMap);var x=function(t,e,n){e.classList.add(`fit-${n}`),z.register(t,e)};const A=l({type:"object",properties:{mimetype:{type:"string"},url:{type:"string"},fit:{type:"string",enum:["cover","contain"]},color:{type:"string"},startDelay:{type:"number",minimum:0},volume:{type:"number",minimum:0,maximum:1},muted:{type:"boolean"},transition:{type:"object",properties:{type:{type:"string"},options:{type:"object"}},required:["type"]},animation:{type:"object",properties:{type:{type:"string"},options:{type:"object"}},required:["type"]}},required:["mimetype","url"]}),O={fit:"cover",color:"black",volume:1,muted:!1,transition:{type:"none",options:{}},animation:{type:"none",options:{}}};var P=class extends r{appendCurrentContent(t,e="black"){t.classList.add("content");const n=document.createElement("div");n.style.setProperty("--slide-background-color",e),n.classList.add("slide"),n.appendChild(t);const i=document.createElement("div");i.classList.add("slide-inner-wrapper"),i.appendChild(n);const a=document.createElement("div");a.classList.add("slide-outer-wrapper"),a.appendChild(i);const{container:o}=this.state;return o.appendChild(a),{slideOuterWrapperElement:a,slideInnerWrapperElement:i,slideElement:n,contentElement:t}}removePreviousSlides(t){const{activeSlides:e}=this.state,n=e.indexOf(t);if(-1!==n){const t=e.slice(0,n);e.splice(0,n),t.forEach((t=>{const{parentNode:e}=t.slideOuterWrapperElement;null!==e&&e.removeChild(t.slideOuterWrapperElement),t.transition.cancel(),t.animation.cancel()}))}}async execute(t){const e=this.prepareTransition(t),n=this.prepareAnimation(t),{mimetype:i,url:a,fit:o,color:r,startDelay:s,volume:c,muted:l}={...O,...t},{preloader:m}=this.state,d=E.create(i,a,m),p=this.appendCurrentContent(d,null!=r?r:"black");x(p.slideElement,d,o),E.setMuted(d,this.state.muted||l),E.setVolume(d,c,"absolute");const u=e(p.slideOuterWrapperElement),h=n(p.slideElement),{targetShowUpDelay:y}=u,v=setTimeout((()=>E.play(d)),1e3*(null!=s?s:y)),f={...p,transition:u,animation:h,contentPlayTimeoutId:v},{activeSlides:g}=this.state;g.push(f);try{await u.out()}catch(t){const e="Waiting for transition.out() failed. Proceeding anyway";t?this.state.log.warn(e,t):this.state.log.warn(e)}this.removePreviousSlides(f)}prepareTransition({transition:t}){const{type:e,options:n}=null!=t?t:{type:"none",options:{}},{transitionFactory:i}=this.state;return i.prepare(e,n)}prepareAnimation({animation:t}){const{type:e,options:n}=null!=t?t:{type:"none",options:{}},{animationFactory:i}=this.state;return i.prepare(e,n)}unpack(t){return A(t)}constructor(t){super(t)}};const C=l({type:"object",properties:{color:{type:"string"},transition:{type:"object",properties:{type:{type:"string"},options:{type:"object"}},required:["type"]}}}),R={color:"black",transition:{type:"none",options:{}}};var S=class extends r{async execute(t){const e={...R,...t,mimetype:"image/gif",url:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",animation:{type:"none"}},{viewer:n}=this.state;await n.execute("show",e)}unpack(t){return C(t)}constructor(t){super(t)}};function j(t,e,n){const i=document.createElement("style");void 0!==n&&(i.id=n),i.textContent=e;const a=t.querySelector("style[type='text/css']:last-of-type, style:not([type]):last-of-type");null===a?t.prepend(i):a.after(i)}function T(t,e,n,i){void 0!==i&&t.style.setProperty(e,n(i))}var L={};o(L,"NoneAnimation",(function(){return H}),(function(t){return H=t}));var I,F=class extends class{isCancelled(){return this._isCancelled}done(){return this.donePEC.promise()}isDone(){return this._isDone}constructor(e){t(this,"element",void 0),t(this,"_isCancelled",!1),t(this,"_isDone",!1),t(this,"donePEC",void 0),this.element=e,this.donePEC=new v,this.donePEC.promise().catch((()=>{}))}}{addClasses(){const{classList:t}=this.cssBasedAnimationOptions,{element:e}=this;t.forEach((t=>e.classList.add(t)))}removeClasses(){const{classList:t}=this.cssBasedAnimationOptions,{element:e}=this;t.forEach((t=>e.classList.remove(t)))}end(){this.isCancelled()||this.isDone()||(this.cleanup(this.cssBasedAnimationOptions.removeAtEnd),this._isDone=!0,this.donePEC.resolve())}cancelled(){this.isCancelled()||this.isDone()||(this.cleanup(this.cssBasedAnimationOptions.removeOnCancel),this._isCancelled=!0,this.donePEC.reject())}cancel(){this.isCancelled()||this.isDone()||(this.cssBasedAnimationOptions.removeOnCancel?this.removeClasses():this.cancelled())}cleanup(t){const{element:e,cssBasedAnimationOptions:n}=this,{cssPropertyRemover:i}=n;e.removeEventListener("animationend",this.endHandler),e.removeEventListener("animationcancel",this.cancelHandler),t?(this.removeClasses(),i(e)):e.style.animationPlayState="paused"}constructor(e,n){super(e),t(this,"endHandler",void 0),t(this,"cancelHandler",void 0),t(this,"cssBasedAnimationOptions",void 0);const{element:i}=this;this.cssBasedAnimationOptions={classList:[],cssPropertySetter:()=>{},cssPropertyRemover:()=>{},endEventFilter:()=>!0,cancelEventFilter:()=>!0,removeAtEnd:!0,removeOnCancel:!0,...n};const{cssPropertySetter:a,endEventFilter:o,cancelEventFilter:r}=this.cssBasedAnimationOptions;this.addClasses(),a(i),this.endHandler=t=>{o(t)&&this.end()},this.cancelHandler=t=>{r(t)&&this.cancelled()},i.addEventListener("animationend",this.endHandler),i.addEventListener("animationcancel",this.cancelHandler)}},D=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const M=l({type:"object",properties:{delay:{type:"number",minimum:0},duration:{type:"number",minimum:0}}});let H=I=class extends F{static createCssBasedAnimationOptions(t){const e=({animationName:t})=>"animation-none"===t;return{classList:["animation","animation-none"],endEventFilter:e,cancelEventFilter:e,cssPropertySetter:e=>{const{delay:n,duration:i}=t,a=T;a(e,"--animation-none-delay",(t=>`${t}s`),n),a(e,"--animation-none-duration",(t=>`${t}s`),i)},cssPropertyRemover:t=>{["--animation-none-delay","--animation-none-duration"].forEach((e=>t.style.removeProperty(e)))},removeAtEnd:!1,removeOnCancel:!1}}static unpack(t){return M(t)}static prepare(t){const e=I.unpack(t);return t=>new I(t,e)}static getStyleSheetAsString(){return a("@-webkit-keyframes animation-none{0%,to{opacity:1}}@keyframes animation-none{0%,to{opacity:1}}.animation-none{--animation-none-delay:0s;--animation-none-duration:0s}.animation-none>.content{-webkit-animation-delay:var(--animation-none-delay);-webkit-animation-delay:var(--animation-none-delay);animation-delay:var(--animation-none-delay);-webkit-animation-duration:var(--animation-none-duration);-webkit-animation-duration:var(--animation-none-duration);animation-duration:var(--animation-none-duration);-webkit-animation-name:animation-none;animation-name:animation-none;-webkit-animation-fill-mode:both;animation-fill-mode:both}")}constructor(t,e){super(t,I.createCssBasedAnimationOptions(e))}};H=I=D([t=>t],H);var B={};o(B,"PanZoomAnimation",(function(){return V}),(function(t){return V=t}));var $,_=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const N={type:"object",properties:{x:{type:"number"},y:{type:"number"},scale:{type:"number",minimum:0}}},U=l({type:"object",properties:{delay:{type:"number",minimum:0},duration:{type:"number",minimum:0},from:N,to:N}});let V=$=class extends F{static createCssBasedAnimationOptions(t){const e=({animationName:t})=>"animation-pan-zoom"===t;return{classList:["animation","animation-pan-zoom"],endEventFilter:e,cancelEventFilter:e,cssPropertySetter:e=>{const{delay:n,duration:i,from:a,to:o}=t,r=T;r(e,"--animation-pan-zoom-delay",(t=>`${t}s`),n),r(e,"--animation-pan-zoom-duration",(t=>`${t}s`),i),r(e,"--animation-pan-zoom-origin-x",(t=>`${t}`),null==a?void 0:a.x),r(e,"--animation-pan-zoom-origin-y",(t=>`${t}`),null==a?void 0:a.y),r(e,"--animation-pan-zoom-origin-scale",(t=>`${t}`),null==a?void 0:a.scale),r(e,"--animation-pan-zoom-target-x",(t=>`${t}`),null==o?void 0:o.x),r(e,"--animation-pan-zoom-target-y",(t=>`${t}`),null==o?void 0:o.y),r(e,"--animation-pan-zoom-target-scale",(t=>`${t}`),null==o?void 0:o.scale)},cssPropertyRemover:t=>{["--animation-pan-zoom-delay","--animation-pan-zoom-duration","--animation-pan-zoom-origin-x","--animation-pan-zoom-origin-y","--animation-pan-zoom-origin-scale","--animation-pan-zoom-target-x","--animation-pan-zoom-target-y","--animation-pan-zoom-target-scale"].forEach((e=>t.style.removeProperty(e)))},removeAtEnd:!1,removeOnCancel:!1}}static unpack(t){return U(t)}static prepare(t){const e=$.unpack(t);return t=>new $(t,e)}static getStyleSheetAsString(){return a("@-webkit-keyframes animation-pan-zoom{0%{-webkit-transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)));-webkit-transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)));transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)))}to{-webkit-transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)));-webkit-transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)));transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)))}}@keyframes animation-pan-zoom{0%{-webkit-transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)));-webkit-transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)));transform:scale(var(--animation-pan-zoom-origin-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-origin-x)),calc(50% - 100%*var(--animation-pan-zoom-origin-y)))}to{-webkit-transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)));-webkit-transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)));transform:scale(var(--animation-pan-zoom-target-scale))translate(calc(50% - 100%*var(--animation-pan-zoom-target-x)),calc(50% - 100%*var(--animation-pan-zoom-target-y)))}}.animation-pan-zoom{--animation-pan-zoom-delay:0s;--animation-pan-zoom-duration:0s;--animation-pan-zoom-origin-x:.5;--animation-pan-zoom-origin-y:.5;--animation-pan-zoom-origin-scale:1;--animation-pan-zoom-target-x:.5;--animation-pan-zoom-target-y:.5;--animation-pan-zoom-target-scale:1}.animation-pan-zoom .content{-webkit-transform-origin:50%;transform-origin:50%;-webkit-animation-name:animation-pan-zoom;animation-name:animation-pan-zoom;-webkit-animation-delay:var(--animation-pan-zoom-delay);-webkit-animation-delay:var(--animation-pan-zoom-delay);animation-delay:var(--animation-pan-zoom-delay);-webkit-animation-duration:var(--animation-pan-zoom-duration);-webkit-animation-duration:var(--animation-pan-zoom-duration);animation-duration:var(--animation-pan-zoom-duration);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}")}constructor(t,e){super(t,$.createCssBasedAnimationOptions(e))}};V=$=_([t=>t],V);var W=class{registerKnownTransitions(){this.register("none",L.NoneAnimation),this.register("pan-zoom",B.PanZoomAnimation)}register(t,e){if(this.animationRegistry.has(t))throw new Error("Animation type already registered");j(this.root,e.getStyleSheetAsString(),`animation-${t}`),this.animationRegistry.set(t,e)}prepare(t="none",e={}){const n=this.animationRegistry.get(t);if(!n)throw new Error(`Unknown animation type: ${t}`);return n.prepare(e)}constructor(e){t(this,"root",void 0),t(this,"animationRegistry",new Map),this.root=e,this.registerKnownTransitions()}},q={};o(q,"NoneTransition",(function(){return Q}),(function(t){return Q=t}));var G,K=class extends F{outEnd(){this.isCancelled()||this.isOut()||(this.element.removeEventListener("animationend",this.outEndHandler),this._isOut=!0,this.outPEC.resolve())}out(){return this.outPEC.promise()}isOut(){return this._isOut}cancel(){this.isCancelled()||this.isDone()||(this.outPEC.reject(),super.cancel())}constructor(e,n){super(e,n),t(this,"targetShowUpDelay",void 0),t(this,"_isOut",!1),t(this,"outPEC",void 0),t(this,"outEndHandler",void 0),this.targetShowUpDelay=n.targetShowUpDelay,this.outPEC=new v,this.outPEC.promise().catch((()=>{}));const{outEndEventFilter:i}={classList:[],cssPropertySetter:()=>{},cssPropertyRemover:()=>{},endEventFilter:()=>!0,cancelEventFilter:()=>!0,removeAtEnd:!0,removeOnCancel:!0,outEndEventFilter:()=>!0,...n};this.outEndHandler=t=>{i(t)&&this.outEnd()},e.addEventListener("animationend",this.outEndHandler)}},J=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const Z=l({type:"object",properties:{delay:{type:"number",minimum:0},duration:{type:"number",minimum:0}}});let Q=G=class extends K{static createCssBasedTransitionOptions(t){const e=({animationName:t})=>"transition-none"===t,{delay:n,duration:i}=t;return{classList:["transition","transition-none"],outEndEventFilter:({animationName:t})=>"transition-none-out"===t,endEventFilter:e,cancelEventFilter:e,cssPropertySetter:t=>{const e=T;e(t,"--transition-none-delay",(t=>`${t}s`),n),e(t,"--transition-none-duration",(t=>`${t}s`),i)},cssPropertyRemover:t=>{["--transition-none-delay","--transition-none-duration"].forEach((e=>t.style.removeProperty(e)))},removeAtEnd:!0,removeOnCancel:!0,targetShowUpDelay:null!=n?n:0}}static unpack(t){return Z(t)}static prepare(t){const e=G.unpack(t);return t=>new G(t,e)}static getStyleSheetAsString(){return a("@-webkit-keyframes transition-none{0%,to{opacity:1}}@keyframes transition-none{0%,to{opacity:1}}@-webkit-keyframes transition-none-out{0%,to{opacity:1}}@keyframes transition-none-out{0%,to{opacity:1}}.transition-none{--transition-none-delay:0s;--transition-none-duration:0s;opacity:0;-webkit-animation-delay:var(--transition-none-delay);-webkit-animation-delay:var(--transition-none-delay);animation-delay:var(--transition-none-delay);-webkit-animation-duration:var(--transition-none-duration),0s;-webkit-animation-duration:var(--transition-none-duration),0s;animation-duration:var(--transition-none-duration),0s;-webkit-animation-name:transition-none,transition-none-out;animation-name:transition-none,transition-none-out;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}")}constructor(e,n){super(e,G.createCssBasedTransitionOptions(n)),t(this,"targetShowUpDelay",0)}};Q=G=J([t=>t],Q);var X={};o(X,"FadeTransition",(function(){return nt}),(function(t){return nt=t}));var Y,tt=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const et=l({type:"object",properties:{delay:{type:"number",minimum:0},duration:{type:"number",minimum:0},color:{type:"string"}}});let nt=Y=class extends K{static createCssBasedTransitionOptions(t){const e=({animationName:t})=>"transition-fade"===t,{delay:n,duration:i,color:a}={duration:2,...t};return{classList:["transition","transition-fade"],outEndEventFilter:({animationName:t})=>"transition-fade-overlay"===t,endEventFilter:e,cancelEventFilter:e,cssPropertySetter:t=>{const e=T;e(t,"--transition-fade-delay",(t=>`${t}s`),n),e(t,"--transition-fade-duration",(t=>`${t}s`),i),e(t,"--transition-fade-color",(t=>`${t}`),a)},cssPropertyRemover:t=>{["--transition-fade-delay","--transition-fade-duration","--transition-fade-color"].forEach((e=>t.style.removeProperty(e)))},removeAtEnd:!0,removeOnCancel:!0,targetShowUpDelay:(null!=n?n:0)+i/2}}static unpack(t){return et(t)}static prepare(t){const e=Y.unpack(t);return t=>new Y(t,e)}static getStyleSheetAsString(){return a('@-webkit-keyframes transition-fade-overlay{0%{opacity:0}to{opacity:1}}@keyframes transition-fade-overlay{0%{opacity:0}to{opacity:1}}@-webkit-keyframes transition-fade{0%{opacity:0}to{opacity:1}}@keyframes transition-fade{0%{opacity:0}to{opacity:1}}.transition-fade{--transition-fade-delay:0s;--transition-fade-duration:-1s;--transition-fade-duration-half:calc(var(--transition-fade-duration)/2);--transition-fade-color:black}.transition-fade>*,.transition-fade:before{-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--transition-fade-duration-half);-webkit-animation-duration:var(--transition-fade-duration-half);animation-duration:var(--transition-fade-duration-half)}.transition-fade>*{-webkit-animation-name:transition-fade;animation-name:transition-fade;-webkit-animation-delay:calc(var(--transition-fade-delay) + var(--transition-fade-duration-half));-webkit-animation-delay:calc(var(--transition-fade-delay) + var(--transition-fade-duration-half));animation-delay:calc(var(--transition-fade-delay) + var(--transition-fade-duration-half))}.transition-fade:before{content:"";background-color:var(--transition-fade-color);width:100%;height:100%;-webkit-animation-name:transition-fade-overlay;animation-name:transition-fade-overlay;position:absolute;top:0;left:0}')}constructor(t,e){super(t,Y.createCssBasedTransitionOptions(e))}};nt=Y=tt([t=>t],nt);var it={};o(it,"CrossFadeTransition",(function(){return st}),(function(t){return st=t}));var at,ot=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};const rt=l({type:"object",properties:{delay:{type:"number",minimum:0},duration:{type:"number",minimum:0}}});let st=at=class extends K{static createCssBasedTransitionOptions(t){const e=({animationName:t})=>"transition-cross-fade"===t,{delay:n,duration:i}=t;return{classList:["transition","transition-cross-fade"],outEndEventFilter:e,endEventFilter:e,cancelEventFilter:e,cssPropertySetter:t=>{const e=T;e(t,"--transition-cross-fade-delay",(t=>`${t}s`),n),e(t,"--transition-cross-fade-duration",(t=>`${t}s`),i)},cssPropertyRemover:t=>{["--transition-cross-fade-delay","--transition-cross-fade-duration"].forEach((e=>t.style.removeProperty(e)))},removeAtEnd:!0,removeOnCancel:!0,targetShowUpDelay:null!=n?n:0}}static unpack(t){return rt(t)}static prepare(t){const e=at.unpack(t);return t=>new at(t,e)}static getStyleSheetAsString(){return a("@-webkit-keyframes transition-cross-fade{0%{opacity:0}to{opacity:1}}@keyframes transition-cross-fade{0%{opacity:0}to{opacity:1}}.transition-cross-fade{--transition-cross-fade-delay:0s;--transition-cross-fade-duration:1s;-webkit-animation-delay:var(--transition-cross-fade-delay);-webkit-animation-delay:var(--transition-cross-fade-delay);animation-delay:var(--transition-cross-fade-delay);-webkit-animation-duration:var(--transition-cross-fade-duration);-webkit-animation-duration:var(--transition-cross-fade-duration);animation-duration:var(--transition-cross-fade-duration);-webkit-animation-name:transition-cross-fade;animation-name:transition-cross-fade;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}")}constructor(t,e){super(t,at.createCssBasedTransitionOptions(e))}};st=at=ot([t=>t],st);var ct=class{registerKnownTransitions(){this.register("none",q.NoneTransition),this.register("fade",X.FadeTransition),this.register("cross-fade",it.CrossFadeTransition)}register(t,e){if(this.transitionRegistry.has(t))throw new Error("Transition type already registered");j(this.root,e.getStyleSheetAsString(),`transition-${t}`),this.transitionRegistry.set(t,e)}prepare(t="none",e={}){const n=this.transitionRegistry.get(t);if(!n)throw new Error(`Unknown transition type: ${t}`);return n.prepare(e)}constructor(e){t(this,"root",void 0),t(this,"transitionRegistry",new Map),this.root=e,this.registerKnownTransitions()}};var lt=class extends r{async execute(){return this.state.activeSlides.forEach((({contentElement:t})=>E.setMuted(t,!0))),this.state.muted=!0,Promise.resolve()}unpack(){}constructor(t){super(t)}};var mt=class extends r{async execute(){return this.state.activeSlides.forEach((({contentElement:t})=>E.setMuted(t,!1))),this.state.muted=!1,Promise.resolve()}unpack(){}constructor(t){super(t)}};const dt=l({oneOf:[{type:"object",properties:{volume:{type:"number",minimum:0,maximum:1},mode:{type:"string",const:"absolute"}},required:["volume"]},{type:"object",properties:{volume:{type:"number",minimum:0},mode:{type:"string",const:"relative"}},required:["volume","mode"]}]}),pt={mode:"absolute"};var ut=class extends r{async execute(t){const{volume:e,mode:n}={...pt,...t};return this.state.activeSlides.forEach((({contentElement:t})=>E.setVolume(t,e,n))),Promise.resolve()}unpack(t){return dt(t)}constructor(t){super(t)}};class ht extends HTMLElement{async execute(t,e){return this.viewer.execute(t,e)}constructor(){super(),t(this,"viewer",void 0),this.viewer=new yt(this,!1)}}class yt{static createActionRegistry(t){const e=new Map;return e.set("reload",new y(t)),e.set("preload",new u(t)),e.set("show",new P(t)),e.set("clear",new S(t)),e.set("mute",new lt(t)),e.set("unmute",new mt(t)),e.set("set-volume",new ut(t)),e}async execute(t,e){return this.executeImpl(t,e)}async executeImpl(t,e){const n=this.actionRegistry.get(t);if(n){const t=n.buildExecutor(e);return await t()}throw new TypeError("HilbertGalleryViewer.execute(): unknown action")}static defineCustomElement(){customElements.define("hilbert-gallery-viewer",ht)}constructor(e,n=!0){t(this,"actionRegistry",void 0),t(this,"state",void 0);const i=(n?(t=>{const e=document.createElement("div");return t.appendChild(e)})(e):e).attachShadow({mode:"open"});j(i,a(":host{width:100%;height:100%;max-width:100%;max-height:100%;position:absolute}:host>.container,:host>.container>.slide-outer-wrapper,:host>.container>.slide-outer-wrapper>.slide-inner-wrapper{width:100%;height:100%;max-width:100%;max-height:100%;position:absolute}:host>.container>.slide-outer-wrapper>.slide-inner-wrapper>.slide{--slide-background-color:black;width:100%;height:100%;max-width:100%;max-height:100%;background-color:var(--slide-background-color);--fit-cover-max-width:auto;--fit-cover-max-height:auto;--fit-contain-min-width:auto;--fit-contain-min-height:auto;justify-content:center;align-items:center;display:flex;position:absolute}:host>.container>.slide-outer-wrapper>.slide-inner-wrapper>.slide>.content{position:absolute}:host>.container>.slide-outer-wrapper>.slide-inner-wrapper>.slide>.content.fit-cover{max-width:var(--fit-contain-max-width);max-height:var(--fit-contain-max-height);min-width:100%;min-height:100%}:host>.container>.slide-outer-wrapper>.slide-inner-wrapper>.slide>.content.fit-contain{min-width:var(--fit-contain-min-width);min-height:var(--fit-contain-min-height);max-width:100%;max-height:100%}.preload-area{display:none}"));const o=document.createElement("div");o.classList.add("preload-area"),i.appendChild(o);const r=document.createElement("div");r.classList.add("container"),i.appendChild(r);const s=new ct(i),c=new W(i);this.state={viewer:this,log:new h(d.WARN),preloader:new w(o),shadowRoot:i,container:r,transitionFactory:s,animationFactory:c,activeSlides:[],muted:!1},this.actionRegistry=yt.createActionRegistry(this.state)}}yt.defineCustomElement();var vt=yt;export{vt as default};
//# sourceMappingURL=index.mjs.map
