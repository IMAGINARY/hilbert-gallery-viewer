{"mappings":"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","sources":["src/library/ts/index.ts","src/library/ts/hilbert-gallery-viewer.ts","node_modules/@parcel/runtime-js/lib/bundles/runtime-1849d6d0d0b89159.js","src/library/ts/action/preload.ts","src/library/ts/action/base.ts","src/library/ts/util/preloader.ts","src/library/ts/util/log.ts","src/library/ts/action/reload.ts","src/library/ts/action/show.ts","src/library/ts/util/content-creator.ts","src/library/ts/transition/factory.ts","src/library/ts/transition/none.ts","src/library/ts/transition/base.ts","src/library/ts/util/promise.ts","src/library/ts/transition/fade.ts","node_modules/@parcel/runtime-js/lib/bundles/runtime-93582ece5f98bb15.js","src/library/ts/transition/cross-fade.ts","node_modules/@parcel/runtime-js/lib/bundles/runtime-9dc6ede58338fe34.js","src/library/ts/util/style.ts","src/library/ts/animation/factory.ts","src/library/ts/animation/none.ts","src/library/ts/animation/base.ts","src/library/ts/animation/pan-zoom.ts","node_modules/@parcel/runtime-js/lib/bundles/runtime-3d87d007049f0f44.js"],"sourcesContent":["export * from './hilbert-gallery-viewer';\nexport * from './util/preloader';\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport cssText from 'bundle-text:../scss/viewer.scss';\n\nimport 'core-js/actual/promise';\n\nimport { Action } from './action/action';\nimport { PreloadAction } from './action/preload';\nimport { Log, LogLevel } from './util/log';\nimport { State } from './util/types';\nimport { ReloadAction } from './action/reload';\nimport { ShowAction } from './action/show';\nimport assert from 'assert';\nimport { appendStyle } from './util/style';\n\ntype ActionRegistry = Map<string, Action<unknown, unknown>>;\n\nexport default class HilbertGalleryViewer extends HTMLElement {\n  protected actionRegistry: ActionRegistry;\n\n  protected state: State;\n\n  constructor() {\n    super();\n\n    const shadowRoot = this.attachShadow({ mode: 'open' });\n\n    appendStyle(shadowRoot, cssText as string);\n\n    const container = document.createElement('div');\n    container.classList.add('container');\n    shadowRoot.appendChild(container);\n\n    this.state = {\n      log: new Log(LogLevel.WARN),\n      shadowRoot,\n      container,\n    };\n\n    this.actionRegistry = this.createActionRegistry();\n  }\n\n  protected createActionRegistry(): ActionRegistry {\n    const registry = new Map<string, Action<unknown, unknown>>();\n    registry.set('reload', new ReloadAction(this.state));\n    registry.set('preload', new PreloadAction(this.state));\n    registry.set('show', new ShowAction(this.state));\n    return registry;\n  }\n\n  async execute(action: string, arg: unknown): Promise<void> {\n    // executeImpl only exists for the purpose of renaming the parameters\n    await this.executeImpl(action, arg);\n  }\n\n  private async executeImpl(actionName: string, arg: unknown): Promise<void> {\n    const action = this.actionRegistry.get(actionName);\n    if (action) {\n      // this may throw an exception if arg has invalid type\n      const executor = action.buildExecutor(arg);\n      // the executor encapsulates the preprocessed arg\n      // and allows type-safe execution\n      await executor();\n    } else {\n      throw new TypeError('HilbertGalleryViewer.execute(): unknown action');\n    }\n  }\n}\n\ncustomElements.define('hilbert-gallery-viewer', HilbertGalleryViewer);\n\nexport { HilbertGalleryViewer };\n","module.exports = \"4385731e674e6d6c\";","import { Base } from './base';\nimport { Preloader } from '../util/preloader';\nimport { State } from '../util/types';\n\ntype PreloadItem = {\n  mimetype: string;\n  url: string;\n};\n\nexport default class PreloadAction extends Base<PreloadItem[], void> {\n  protected preloader: Preloader;\n\n  constructor(state: State) {\n    super(state);\n    this.preloader = new Preloader();\n  }\n\n  async execute(items: PreloadItem[]): Promise<void> {\n    this.preloader.unref();\n    items.forEach(({ mimetype, url }) => this.preloader.preload(mimetype, url));\n    return Promise.resolve();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  unpack(arg: unknown): PreloadItem[] {\n    if (!Array.isArray(arg)) {\n      throw new TypeError('PreloadAction.unpack(arg): arg must be an array');\n    }\n    const items = arg as unknown[];\n    items.forEach((item, index) => {\n      const { mimetype, url } = item as { mimetype: unknown; url: unknown };\n      if (typeof mimetype !== 'string') {\n        throw new TypeError(\n          `PreloadAction.unpack(arg): item ${index} of args must have a mimetype`,\n        );\n      }\n      if (typeof url !== 'string') {\n        throw new TypeError(\n          `PreloadAction.unpack(arg): item ${index} of arg must have an url`,\n        );\n      }\n    });\n    return arg as PreloadItem[];\n  }\n}\n\nexport { PreloadAction, PreloadItem };\n","import { Action } from './action';\nimport { State } from '../util/types';\n\nexport default abstract class Base<A, R> implements Action<A, R> {\n  protected readonly state: State;\n\n  protected constructor(state: State) {\n    this.state = state;\n  }\n\n  abstract execute(arg: A): Promise<R>;\n\n  abstract unpack(arg: unknown): A;\n\n  buildExecutor(arg: unknown): () => Promise<R> {\n    const unpackedArg: A = this.unpack(arg);\n    return () => this.execute(unpackedArg);\n  }\n}\n\nexport { Base };\n","export default class Preloader {\n  protected refs = new Map<string, unknown>();\n\n  protected typeRegistry = new Map<string, (url: URL | string) => void>();\n\n  constructor() {\n    this.typeRegistry.set('image', this.preloadImage.bind(this));\n    this.typeRegistry.set('video', this.preloadVideo.bind(this));\n  }\n\n  preload(mimetype: string, url: URL | string): boolean {\n    const type = mimetype.split('/', 1)[0];\n    const preloadFunc = this.typeRegistry.get(type);\n    if (preloadFunc) {\n      preloadFunc(url);\n      return true;\n    }\n    return false;\n  }\n\n  preloadImage(url: URL | string): void {\n    const { href } = new URL(url);\n    const image = new Image();\n    image.src = href;\n    this.refs.set(href, image);\n  }\n\n  preloadVideo(url: URL | string) {\n    const { href } = new URL(url);\n    const video = document.createElement('video');\n    video.preload = 'auto';\n    video.src = href;\n    this.refs.set(href, video);\n  }\n\n  unref(...refs: string[]) {\n    if (refs.length === 0) {\n      this.refs.clear();\n    } else {\n      refs.forEach((ref) => this.refs.delete(ref));\n    }\n  }\n}\n\nexport { Preloader };\n","/* eslint-disable no-console */\n\nenum LogLevel {\n  OFF = 0,\n  ERROR = 200,\n  WARN = 300,\n  INFO = 400,\n  DEBUG = 500,\n  TRACE = 600,\n}\n\nexport default class Log {\n  level: LogLevel;\n\n  constructor(level: LogLevel = LogLevel.INFO) {\n    this.level = level;\n  }\n\n  error(...args: unknown[]) {\n    if (this.level >= LogLevel.ERROR) {\n      console.error(...args);\n    }\n  }\n\n  assert(assertion: boolean, ...args: unknown[]) {\n    if (this.level >= LogLevel.ERROR) {\n      console.assert(assertion, ...args);\n    }\n  }\n\n  warn(...args: unknown[]) {\n    if (this.level >= LogLevel.WARN) {\n      console.warn(...args);\n    }\n  }\n\n  info(...args: unknown[]) {\n    if (this.level >= LogLevel.INFO) {\n      console.info(...args);\n    }\n  }\n\n  debug(...args: unknown[]) {\n    if (this.level >= LogLevel.DEBUG) {\n      console.debug(...args);\n    }\n  }\n\n  trace(...args: unknown[]) {\n    if (this.level >= LogLevel.TRACE) {\n      console.trace(...args);\n    }\n  }\n}\n\nexport { Log, LogLevel };\n","import { Base } from './base';\nimport { State } from '../util/types';\n\nexport default class ReloadAction extends Base<void, void> {\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor(state: State) {\n    super(state);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  async execute(): Promise<void> {\n    window.location.reload();\n    return Promise.resolve();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  unpack(): void {}\n}\n\nexport { ReloadAction };\n","import { Base } from './base';\nimport { State } from '../util/types';\nimport { ContentCreator } from '../util/content-creator';\nimport { TransitionFactory } from '../transition/factory';\nimport { Transition } from '../transition/transition';\nimport { NoneTransition } from '../transition/none';\nimport { AnimationFactory } from '../animation/factory';\nimport { Animation } from '../animation/animation';\nimport { NoneAnimation } from '../animation/none';\n\ntype ShowArg = {\n  mimetype: string;\n  url: string;\n  fit: 'cover' | 'contain';\n  color: string;\n  transition: { type: string; options: unknown };\n  animation: { type: string; options: unknown };\n};\n\ntype DOMStructure = {\n  transition: HTMLDivElement;\n  animation: HTMLDivElement;\n  content: HTMLElement;\n};\n\nexport default class ShowAction extends Base<ShowArg, void> {\n  protected transition: Transition;\n\n  protected animation: Animation;\n\n  protected transitionFactory: TransitionFactory;\n\n  protected animationFactory: AnimationFactory;\n\n  protected current: DOMStructure;\n\n  // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n  constructor(state: State) {\n    super(state);\n    this.transitionFactory = new TransitionFactory(state.shadowRoot);\n    this.animationFactory = new AnimationFactory(state.shadowRoot);\n    this.transition = new NoneTransition();\n    this.animation = new NoneAnimation();\n    const dummy = document.createElement('div');\n    this.current = this.appendCurrentContent(dummy, 'black');\n  }\n\n  removePrevious(): void {\n    // keep only current content\n    const { container } = this.state;\n    while (container.children.length > 1) {\n      container.children[0].remove();\n    }\n  }\n\n  cleanup(): void {\n    this.transition.cancel();\n    this.animation.cancel();\n    this.removePrevious();\n  }\n\n  appendCurrentContent(content: HTMLElement, color: string): DOMStructure {\n    const animation = document.createElement('div');\n    animation.classList.add('animation');\n    animation.appendChild(content);\n\n    const transition = document.createElement('div');\n    transition.classList.add('transition');\n    transition.style.setProperty('--transition-background-color', color);\n    transition.appendChild(animation);\n\n    const { container } = this.state;\n    container.appendChild(transition);\n\n    return {\n      transition,\n      animation,\n      content,\n    };\n  }\n\n  async execute(arg: ShowArg): Promise<void> {\n    const { mimetype, url, fit, color } = arg;\n\n    // first parse args and prepare transition and animation\n    const transitionCreator = this.prepareTransition(arg);\n    const animationCreator = this.prepareAnimation(arg);\n\n    // now that arguments are parsed: instantiate everything\n    const content = ContentCreator.create(mimetype, url, fit);\n    try {\n      await ContentCreator.awaitLoad(content);\n    } catch (e) {\n      this.state.log.warn(\n        'Waiting for content to load failed. Proceeding anyway.',\n      );\n    }\n\n    this.cleanup();\n    const previous = this.current;\n    this.current = this.appendCurrentContent(content, color ?? 'black');\n    this.transition = this.createTransition(transitionCreator, previous);\n    try {\n      await this.transition.targetVisible();\n    } catch (e) {\n      this.state.log.warn(\n        'Waiting for target to become visible failed. Proceeding anyway.',\n      );\n    }\n    ContentCreator.play(content);\n    this.animation = this.createAnimation(animationCreator);\n\n    try {\n      await this.transition.done();\n    } catch (e) {\n      const msg = 'Waiting for transition to end failed. Proceeding anyway';\n      if (e) {\n        this.state.log.warn(msg, e);\n      } else {\n        this.state.log.warn(msg);\n      }\n    }\n\n    this.removePrevious();\n  }\n\n  protected prepareTransition(\n    arg: ShowArg,\n  ): ReturnType<TransitionFactory['prepare']> {\n    const { transition } = arg;\n    const { type, options } = transition ?? { type: 'none', options: {} };\n\n    return this.transitionFactory.prepare(type, options);\n  }\n\n  protected prepareAnimation(\n    arg: ShowArg,\n  ): ReturnType<AnimationFactory['prepare']> {\n    const { animation } = arg;\n    const { type, options } = animation ?? { type: 'none', options: {} };\n\n    return this.animationFactory.prepare(type, options);\n  }\n\n  protected createTransition(\n    creator: ReturnType<TransitionFactory['prepare']>,\n    previous: DOMStructure,\n  ): Transition {\n    const { container } = this.state;\n    const from = previous.transition;\n    const to = this.current.transition;\n\n    return creator(container, from, to);\n  }\n\n  protected createAnimation(\n    creator: ReturnType<AnimationFactory['prepare']>,\n  ): Animation {\n    const { animation: wrapper, content } = this.current;\n    return creator(wrapper, content);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  unpack(arg: unknown): ShowArg {\n    if (typeof arg !== 'object') {\n      throw new TypeError('ShowAction.unpack(arg): arg must be an object');\n    }\n    // TODO: further type checking\n    return arg as ShowArg;\n  }\n}\n\nexport { ShowAction };\n","class ContentCreator {\n  static create(\n    mimetype: string,\n    url: string,\n    objectFit: 'contain' | 'cover' = 'cover',\n  ): HTMLElement {\n    const type = mimetype.split('/', 1)[0];\n    let content: HTMLElement;\n    switch (type) {\n      case 'image':\n        content = ContentCreator.createImage(url);\n        break;\n      case 'video':\n        content = ContentCreator.createVideo(url);\n        break;\n      default:\n        content = ContentCreator.createObject(mimetype, url);\n        break;\n    }\n    content.classList.add('content');\n    content.classList.add(`fit-${objectFit}`);\n    return content;\n  }\n\n  protected static createObject(\n    mimetype: string,\n    url: string,\n  ): HTMLObjectElement {\n    const object = document.createElement('object');\n    object.type = mimetype;\n    object.data = url;\n    return object;\n  }\n\n  protected static createImage(url: string): HTMLImageElement {\n    const image = document.createElement('img');\n    image.src = url;\n    return image;\n  }\n\n  protected static createVideo(url: string): HTMLVideoElement {\n    const video = document.createElement('video');\n    video.preload = 'auto';\n    video.src = url;\n    video.autoplay = false;\n    return video;\n  }\n\n  public static async awaitLoad<T extends HTMLElement>(content: T): Promise<T> {\n    return new Promise((resolve) => {\n      if (content.tagName === 'IMG') {\n        const image = content as unknown as HTMLImageElement;\n        if (image.complete) {\n          resolve(content);\n        } else {\n          const handler = () => {\n            image.removeEventListener('load', handler);\n            image.removeEventListener('error', handler);\n            requestAnimationFrame(() => resolve(content));\n          };\n          image.addEventListener('load', handler);\n          image.addEventListener('error', handler);\n        }\n      } else {\n        // consider the transition-ol done after a grace period of 1s\n        setTimeout(() => resolve(content), 1000);\n      }\n    });\n  }\n\n  public static play<T extends HTMLElement>(content: T) {\n    if (content.tagName === 'VIDEO') {\n      const video = content as unknown as HTMLVideoElement;\n      video.play().finally(() => {});\n    }\n  }\n}\n\nexport { ContentCreator };\n","import { Transition, TransitionStatic } from './transition';\nimport { NoneTransition } from './none';\nimport { FadeTransition } from './fade';\nimport { CrossFadeTransition } from './cross-fade';\nimport { appendStyle } from '../util/style';\n\nexport default class TransitionFactory {\n  protected root: DocumentFragment;\n\n  protected transitionRegistry: Map<string, TransitionStatic<Transition, any>> =\n    new Map();\n\n  constructor(root: DocumentFragment) {\n    this.root = root;\n    this.registerKnownTransitions();\n  }\n\n  protected registerKnownTransitions() {\n    this.register('none', NoneTransition);\n    this.register('fade', FadeTransition);\n    this.register('cross-fade', CrossFadeTransition);\n  }\n\n  public register(\n    id: string,\n    transitionClass: TransitionStatic<Transition, any>,\n  ) {\n    if (this.transitionRegistry.has(id)) {\n      throw new Error('Transition type already registered');\n    }\n    appendStyle(\n      this.root,\n      transitionClass.getStyleSheetAsString(),\n      `transition-${id}`,\n    );\n    this.transitionRegistry.set(id, transitionClass);\n  }\n\n  public prepare(\n    type = 'none',\n    options: unknown = {},\n  ): (\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n  ) => Transition {\n    const TransitionClass = this.transitionRegistry.get(type);\n    if (!TransitionClass) {\n      throw new Error(`Unknown transition type: ${type}`);\n    }\n\n    // unpacks the options and throws an exception if they are invalid,\n    // but does create the actual transition yet\n    return TransitionClass.prepare(options);\n  }\n}\n\nexport { TransitionFactory };\n","import { BaseTransition } from './base';\nimport { TransitionStatic } from './transition';\nimport { staticImplements } from '../util/types';\n\n// @staticImplements<TransitionStatic<NoneTransition, void>>()\nexport default class NoneTransition extends BaseTransition {\n  constructor(\n    container: HTMLDivElement = document.createElement('div'),\n    from: HTMLElement = document.createElement('div'),\n    to: HTMLElement = document.createElement('div'),\n  ) {\n    super(container, from, to);\n    this._isCancelled = false;\n    this._isDone = true;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  cancel(): void {}\n\n  // eslint-disable-next-line class-methods-use-this\n  targetVisible(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  done(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  static unpack(): void {}\n\n  static prepare(): (\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n  ) => NoneTransition {\n    return (container: HTMLDivElement, from: HTMLElement, to: HTMLElement) =>\n      new NoneTransition(container, from, to);\n  }\n\n  static getStyleSheetAsString(): string {\n    return '';\n  }\n}\n\nexport { NoneTransition };\n","import { Transition } from './transition';\nimport { PromiseExecutorCallbacks } from '../util/promise';\n\nexport default abstract class BaseTransition implements Transition {\n  protected container: HTMLDivElement;\n\n  protected from: HTMLElement;\n\n  protected to: HTMLElement;\n\n  protected _isCancelled = false;\n\n  protected _isDone = false;\n\n  protected targetVisiblePEC: PromiseExecutorCallbacks<void>;\n\n  protected donePEC: PromiseExecutorCallbacks<void>;\n\n  protected constructor(\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n  ) {\n    this.container = container;\n    this.from = from;\n    this.to = to;\n\n    this.targetVisiblePEC = new PromiseExecutorCallbacks<void>();\n    this.donePEC = new PromiseExecutorCallbacks<void>();\n\n    // prevent uncaught exceptions in promise\n    this.targetVisiblePEC.promise().catch(() => {});\n    this.donePEC.promise().catch(() => {});\n  }\n\n  abstract cancel(): void;\n\n  isCancelled(): boolean {\n    return this._isCancelled;\n  }\n\n  targetVisible(): Promise<void> {\n    return this.targetVisiblePEC.promise();\n  }\n\n  done(): Promise<void> {\n    return this.donePEC.promise();\n  }\n\n  isDone(): boolean {\n    return this._isDone;\n  }\n}\n\nexport { BaseTransition };\n","class PromiseExecutorCallbacks<T> {\n  private readonly _promise: Promise<T>;\n\n  private readonly _resolve: (result: T) => void;\n\n  private readonly _reject: () => void;\n\n  constructor() {\n    // dummy initialization required to satisfy TS2564 (definite assignment)\n    let tmpResolve = (result: T) => {};\n    let tmpReject = () => {};\n    this._promise = new Promise((resolve, reject) => {\n      tmpResolve = resolve;\n      tmpReject = reject;\n    });\n    this._resolve = tmpResolve;\n    this._reject = tmpReject;\n  }\n\n  promise(): Promise<T> {\n    return this._promise;\n  }\n\n  resolve(result: T) {\n    return this._resolve(result);\n  }\n\n  reject() {\n    return this._reject();\n  }\n}\n\nexport { PromiseExecutorCallbacks };\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport cssText from 'bundle-text:../../scss/transition/fade.scss';\n\nimport { BaseTransition } from './base';\nimport { TransitionStatic } from './transition';\nimport { staticImplements } from '../util/types';\n\ntype FadeTransitionOptions = {\n  duration: number;\n  color: string;\n};\n\nconst defaultOptions: FadeTransitionOptions = {\n  duration: 500,\n  color: '#000',\n};\n\n// @staticImplements<TransitionStatic<FadeTransition, FadeTransitionOptions>>()\nexport default class FadeTransition extends BaseTransition {\n  protected fromEndCancelHandler: (event: AnimationEvent) => void;\n\n  protected toEndHandler: (event: AnimationEvent) => void;\n\n  protected toCancelHandler: (event: AnimationEvent) => void;\n\n  constructor(\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n    options: FadeTransitionOptions,\n  ) {\n    super(container, from, to);\n\n    const { duration, color } = { ...defaultOptions, ...(options ?? {}) };\n\n    const { style } = container;\n    style.setProperty('--transition-fade-duration', `${duration}s`);\n    style.setProperty('--transition-fade-color', `${color}`);\n\n    from.classList.add('fade');\n    from.classList.add('fade-out');\n\n    this.fromEndCancelHandler = ({ animationName }: AnimationEvent) => {\n      if (animationName === 'transition-fade-out') {\n        this.targetVisiblePEC.resolve();\n      }\n    };\n    from.addEventListener('animationend', this.fromEndCancelHandler);\n    from.addEventListener('animationcancel', this.fromEndCancelHandler);\n\n    to.classList.add('fade');\n    to.classList.add('fade-in');\n\n    this.toEndHandler = ({ animationName }: AnimationEvent) => {\n      if (animationName === 'transition-fade-in') {\n        this.end();\n      }\n    };\n    this.toCancelHandler = ({ animationName }: AnimationEvent) => {\n      if (animationName === 'transition-fade-in') {\n        this.cancel();\n      }\n    };\n    to.addEventListener('animationend', this.toEndHandler);\n    to.addEventListener('animationcancel', this.toCancelHandler);\n  }\n\n  protected end(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isDone = true;\n      this.targetVisiblePEC.resolve();\n      this.donePEC.resolve();\n    }\n  }\n\n  cancel(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isCancelled = true;\n      this.targetVisiblePEC.resolve();\n      this.donePEC.reject();\n    }\n  }\n\n  protected cleanup() {\n    this.from.removeEventListener('animationend', this.fromEndCancelHandler);\n    this.from.removeEventListener('animationcancel', this.fromEndCancelHandler);\n\n    this.to.removeEventListener('animationend', this.toEndHandler);\n    this.to.removeEventListener('animationcancel', this.toCancelHandler);\n\n    const { style } = this.container;\n    style.removeProperty('--transition-fade-duration');\n    style.removeProperty('--transition-fade-color');\n\n    this.from.classList.remove('fade');\n    this.from.classList.remove('fade-out');\n\n    this.to.classList.remove('fade');\n    this.to.classList.remove('fade-in');\n  }\n\n  static unpack(options: unknown): FadeTransitionOptions {\n    return options as FadeTransitionOptions;\n  }\n\n  static prepare(\n    options: unknown,\n  ): (\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n  ) => FadeTransition {\n    const unpackedOptions = FadeTransition.unpack(options);\n    return (container: HTMLDivElement, from: HTMLElement, to: HTMLElement) =>\n      new FadeTransition(container, from, to, unpackedOptions);\n  }\n\n  static getStyleSheetAsString(): string {\n    return cssText as string;\n  }\n}\n\nexport { FadeTransition, FadeTransitionOptions };\n","module.exports = \"3d4632243bfdc001\";","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport cssText from 'bundle-text:../../scss/transition/cross-fade.scss';\n\nimport { BaseTransition } from './base';\nimport { TransitionStatic } from './transition';\nimport { staticImplements } from '../util/types';\n\ntype CrossFadeTransitionOptions = {\n  duration: number;\n};\n\nconst defaultOptions: CrossFadeTransitionOptions = {\n  duration: 500,\n};\n\n// @staticImplements<TransitionStatic<CrossFadeTransition, CrossFadeTransitionOptions>>()\nexport default class CrossFadeTransition extends BaseTransition {\n  protected toEndHandler: (event: AnimationEvent) => void;\n\n  protected toCancelHandler: (event: AnimationEvent) => void;\n\n  constructor(\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n    options: CrossFadeTransitionOptions,\n  ) {\n    super(container, from, to);\n\n    const { duration } = { ...defaultOptions, ...(options ?? {}) };\n\n    const { style } = container;\n    style.setProperty('--transition-cross-fade-duration', `${duration}s`);\n\n    from.classList.add('cross-fade');\n    from.classList.add('cross-fade-out');\n\n    to.classList.add('cross-fade');\n    to.classList.add('cross-fade-in');\n\n    this.toEndHandler = ({ animationName }: AnimationEvent) => {\n      if (animationName === 'transition-cross-fade-in') {\n        this.end();\n      }\n    };\n    this.toCancelHandler = ({ animationName }: AnimationEvent) => {\n      if (animationName === 'transition-cross-fade-in') {\n        this.cancel();\n      }\n    };\n    to.addEventListener('animationend', this.toEndHandler);\n    to.addEventListener('animationcancel', this.toCancelHandler);\n\n    this.targetVisiblePEC.resolve();\n  }\n\n  protected end(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isDone = true;\n      this.donePEC.resolve();\n    }\n  }\n\n  cancel(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isCancelled = true;\n      this.donePEC.reject();\n    }\n  }\n\n  protected cleanup() {\n    this.to.removeEventListener('animationend', this.toEndHandler);\n    this.to.removeEventListener('animationcancel', this.toCancelHandler);\n\n    const { style } = this.container;\n    style.removeProperty('--transition-cross-fade-duration');\n\n    this.from.classList.remove('cross-fade');\n    this.from.classList.remove('cross-fade-out');\n\n    this.to.classList.remove('cross-fade');\n    this.to.classList.remove('cross-fade-in');\n  }\n\n  static unpack(options: unknown): CrossFadeTransitionOptions {\n    return options as CrossFadeTransitionOptions;\n  }\n\n  static prepare(\n    options: unknown,\n  ): (\n    container: HTMLDivElement,\n    from: HTMLElement,\n    to: HTMLElement,\n  ) => CrossFadeTransition {\n    const unpackedOptions = CrossFadeTransition.unpack(options);\n    return (container: HTMLDivElement, from: HTMLElement, to: HTMLElement) =>\n      new CrossFadeTransition(container, from, to, unpackedOptions);\n  }\n\n  static getStyleSheetAsString(): string {\n    return cssText as string;\n  }\n}\n\nexport { CrossFadeTransition, CrossFadeTransitionOptions };\n","module.exports = \"d5c5029c2585012b\";","/* eslint-disable import/prefer-default-export */\n\nfunction appendStyle(\n  root: DocumentFragment,\n  stylesheetText: string,\n  id?: string,\n) {\n  const style: HTMLStyleElement = document.createElement('style');\n  if (typeof id !== 'undefined') {\n    style.id = id;\n  }\n  style.textContent = stylesheetText;\n  const selector =\n    \"style[type='text/css']:last-of-type, style:not([type]):last-of-type\";\n  const lastStyleElem = root.querySelector(selector);\n  if (lastStyleElem === null) {\n    root.prepend(style);\n  } else {\n    lastStyleElem.after(style);\n  }\n}\n\nexport { appendStyle };\n","import { Animation, AnimationStatic } from './animation';\nimport { appendStyle } from '../util/style';\nimport { NoneAnimation } from './none';\nimport { PanZoomAnimation } from './pan-zoom';\n\nclass AnimationFactory {\n  protected root: DocumentFragment;\n\n  protected animationRegistry: Map<string, AnimationStatic<Animation, any>> =\n    new Map();\n\n  constructor(root: DocumentFragment) {\n    this.root = root;\n    this.registerKnownTransitions();\n  }\n\n  protected registerKnownTransitions() {\n    this.register('none', NoneAnimation);\n    this.register('pan-zoom', PanZoomAnimation);\n  }\n\n  public register(id: string, AnimationClass: AnimationStatic<Animation, any>) {\n    if (this.animationRegistry.has(id)) {\n      throw new Error('Animation type already registered');\n    }\n    appendStyle(\n      this.root,\n      AnimationClass.getStyleSheetAsString(),\n      `animation-${id}`,\n    );\n    this.animationRegistry.set(id, AnimationClass);\n  }\n\n  public prepare(\n    type = 'none',\n    options: unknown = {},\n  ): (wrapper: HTMLDivElement, content: HTMLElement) => Animation {\n    const AnimationClass = this.animationRegistry.get(type);\n    if (!AnimationClass) {\n      throw new Error(`Unknown animation type: ${type}`);\n    }\n\n    // unpacks the options and throws an exception if they are invalid,\n    // but does create the actual transition yet\n    return AnimationClass.prepare(options);\n  }\n}\n\nexport { AnimationFactory };\n","import { BaseAnimation } from './base';\nimport { AnimationStatic } from './animation';\nimport { staticImplements } from '../util/types';\n\n// @staticImplements<AnimationStatic<NoneAnimation, void>>()\nclass NoneAnimation extends BaseAnimation {\n  constructor(\n    wrapper: HTMLDivElement = document.createElement('div'),\n    content: HTMLElement = document.createElement('div'),\n  ) {\n    super(wrapper, content);\n    this._isCancelled = false;\n    this._isDone = true;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  cancel(): void {}\n\n  // eslint-disable-next-line class-methods-use-this\n  targetVisible(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  done(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  static unpack(): void {}\n\n  static prepare(): (\n    wrapper: HTMLDivElement,\n    content: HTMLElement,\n  ) => NoneAnimation {\n    return (wrapper: HTMLDivElement, content: HTMLElement) =>\n      new NoneAnimation(wrapper, content);\n  }\n\n  static getStyleSheetAsString(): string {\n    return '';\n  }\n}\n\nexport { NoneAnimation };\n","import { Animation } from './animation';\nimport { PromiseExecutorCallbacks } from '../util/promise';\n\nexport default abstract class BaseAnimation implements Animation {\n  protected wrapper: HTMLDivElement;\n\n  protected content: HTMLElement;\n\n  protected _isCancelled = false;\n\n  protected _isDone = false;\n\n  protected donePEC: PromiseExecutorCallbacks<void>;\n\n  protected constructor(wrapper: HTMLDivElement, content: HTMLElement) {\n    this.wrapper = wrapper;\n    this.content = content;\n\n    this.donePEC = new PromiseExecutorCallbacks<void>();\n\n    // prevent uncaught exceptions in promise\n    this.donePEC.promise().catch(() => {});\n  }\n\n  abstract cancel(): void;\n\n  isCancelled(): boolean {\n    return this._isCancelled;\n  }\n\n  done(): Promise<void> {\n    return this.donePEC.promise();\n  }\n\n  isDone(): boolean {\n    return this._isDone;\n  }\n}\n\nexport { BaseAnimation };\n","// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport cssText from 'bundle-text:../../scss/animation/pan-zoom.scss';\n\nimport { BaseAnimation } from './base';\nimport { AnimationStatic } from './animation';\nimport { RequireOnlyOne, staticImplements } from '../util/types';\n\ntype Target = {\n  x: number;\n  y: number;\n  scale: number;\n};\n\ntype PanZoomAnimationOptions = {\n  duration: number;\n  from?: RequireOnlyOne<Target>;\n  to: RequireOnlyOne<Target>;\n};\n\nfunction setCSSPropertyIfDefined<T>(\n  elem: HTMLElement,\n  property: string,\n  formatter: (v: Exclude<T, undefined>) => string,\n  value: T,\n) {\n  if (typeof value !== 'undefined')\n    elem.style.setProperty(property, formatter(value as Exclude<T, undefined>));\n}\n\n// @staticImplements<AnimationStatic<PanZoomAnimation, PanZoomAnimationOptions>>()\nexport default class PanZoomAnimation extends BaseAnimation {\n  protected endHandler: (event: AnimationEvent) => void;\n\n  protected cancelHandler: (event: AnimationEvent) => void;\n\n  constructor(\n    wrapper: HTMLDivElement,\n    content: HTMLElement,\n    options: PanZoomAnimationOptions,\n  ) {\n    super(wrapper, content);\n    this.endHandler = () => {};\n    this.cancelHandler = () => {};\n    this.asyncInit(options).finally(() => {});\n  }\n\n  async asyncInit(options: PanZoomAnimationOptions) {\n    this.wrapper.classList.add('animation-pan-zoom');\n\n    if (typeof options.from !== 'undefined') {\n      try {\n        const { from } = options;\n        this.setDefinedCssProperties(0, from);\n\n        // let the values settle on the next frame\n        await new Promise((resolve) => {\n          requestAnimationFrame(resolve);\n        });\n      } catch (e) {\n        // eslint-disable-next-line no-empty\n      }\n    }\n\n    if (!this.isCancelled()) {\n      const { duration, to } = options;\n      this.setDefinedCssProperties(duration, to);\n\n      this.endHandler = ({ animationName }) => {\n        if (animationName === 'animation-pan-zoom-animation') {\n          this.end();\n        }\n      };\n      this.cancelHandler = ({ animationName }) => {\n        if (animationName === 'animation-pan-zoom-animation') {\n          this.cancel();\n        }\n      };\n\n      this.wrapper.addEventListener('animationend', this.endHandler);\n      this.wrapper.addEventListener('animationcancel', this.cancelHandler);\n    }\n  }\n\n  protected setDefinedCssProperties(\n    duration: number,\n    { x, y, scale }: RequireOnlyOne<Target>,\n  ) {\n    const { wrapper: w } = this;\n    const s = setCSSPropertyIfDefined;\n    s(w, '--animation-pan-zoom-duration', (v) => `${v}s`, duration);\n    s(w, '--animation-pan-zoom-target-x', (v) => `${v}`, x);\n    s(w, '--animation-pan-zoom-target-y', (v) => `${v}`, y);\n    s(w, '--animation-pan-zoom-target-scale', (v) => `${v}`, scale);\n  }\n\n  protected end(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isDone = true;\n      this.donePEC.resolve();\n    }\n  }\n\n  cancel(): void {\n    if (!this.isCancelled() && !this.isDone()) {\n      this.cleanup();\n      this._isCancelled = true;\n      this.donePEC.reject();\n    }\n  }\n\n  protected cleanup() {\n    const { wrapper } = this;\n\n    wrapper.addEventListener('animationend', this.endHandler);\n    wrapper.addEventListener('animationcancel', this.cancelHandler);\n\n    /**\n     * We do not remove the CSS classes and custom properties to keep the\n     * forwards fill-mode of the animation (target state).\n     */\n  }\n\n  static unpack(options: unknown): PanZoomAnimationOptions {\n    return options as PanZoomAnimationOptions;\n  }\n\n  static prepare(\n    options: unknown,\n  ): (wrapper: HTMLDivElement, content: HTMLElement) => PanZoomAnimation {\n    const unpackedOptions = PanZoomAnimation.unpack(options);\n    return (wrapper: HTMLDivElement, content: HTMLElement) =>\n      new PanZoomAnimation(wrapper, content, unpackedOptions);\n  }\n\n  static getStyleSheetAsString(): string {\n    return cssText as string;\n  }\n}\n\nexport { PanZoomAnimation, PanZoomAnimationOptions };\n","module.exports = \"f11aa333bedc7b0a\";"],"names":[],"version":3,"file":"hilbert-gallery-viewer.mjs.map"}