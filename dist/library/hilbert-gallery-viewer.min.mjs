function t(t){return t&&t.__esModule?t.default:t}var e,n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},a=function(t){return t&&t.Math==Math&&t};i=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof r&&r)||function(){return this}()||Function("return this")();var o,s;o=!(s=function(t){try{return!!t()}catch(t){return!0}})((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}));var c,l={};c=!s((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}));var u,d=Function.prototype.call;l=c?d.bind(d):function(){return d.apply(d,arguments)};var f={}.propertyIsEnumerable,p=Object.getOwnPropertyDescriptor,m=p&&!f.call({1:2},1);u=m?function(t){var e=p(this,t);return!!e&&e.enumerable}:f;var h;h=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}};var v,y,g={},b={},w=Function.prototype,E=w.bind,P=w.call,S=c&&E.bind(P,P),O=(b=c?function(t){return t&&S(t)}:function(t){return t&&function(){return P.apply(t,arguments)}})({}.toString),k=b("".slice);y=function(t){return k(O(t),8,-1)};var C=Object,L=b("".split);g=s((function(){return!C("z").propertyIsEnumerable(0)}))?function(t){return"String"==y(t)?L(t,""):C(t)}:C;var j,z=TypeError;j=function(t){if(null==t)throw z("Can't call method on "+t);return t},v=function(t){return g(j(t))};var R,T,A,_;_=function(t){return"function"==typeof t},A=function(t){return"object"==typeof t?null!==t:_(t)};var x,I={},D=function(t){return _(t)?t:void 0};x=function(t,e){return arguments.length<2?D(i[t]):i[t]&&i[t][e]};var F={};F=b({}.isPrototypeOf);var H,M,N,V={};V=x("navigator","userAgent")||"";var G,$,U=i.process,W=i.Deno,B=U&&U.versions||W&&W.version,q=B&&B.v8;q&&($=(G=q.split("."))[0]>0&&G[0]<4?1:+(G[0]+G[1])),!$&&V&&(!(G=V.match(/Edge\/(\d+)/))||G[1]>=74)&&(G=V.match(/Chrome\/(\d+)/))&&($=+G[1]),N=$,M=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&N&&N<41})),H=M&&!Symbol.sham&&"symbol"==typeof Symbol.iterator;var K=Object;I=H?function(t){return"symbol"==typeof t}:function(t){var e=x("Symbol");return _(e)&&F(e.prototype,K(t))};var Y,X,J,Q=String;J=function(t){try{return Q(t)}catch(t){return"Object"}};var Z=TypeError;X=function(t){if(_(t))return t;throw Z(J(t)+" is not a function")},Y=function(t,e){var n=t[e];return null==n?void 0:X(n)};var tt,et=TypeError;tt=function(t,e){var n,r;if("string"===e&&_(n=t.toString)&&!A(r=l(n,t)))return r;if(_(n=t.valueOf)&&!A(r=l(n,t)))return r;if("string"!==e&&_(n=t.toString)&&!A(r=l(n,t)))return r;throw et("Can't convert object to primitive value")};var nt,rt;var it,at={},ot=Object.defineProperty;it=function(t,e){try{ot(i,t,{value:e,configurable:!0,writable:!0})}catch(n){i[t]=e}return e};var st=i["__core-js_shared__"]||it("__core-js_shared__",{});at=st,(rt=function(t,e){return at[t]||(at[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.2",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.2/LICENSE",source:"https://github.com/zloirock/core-js"});var ct,lt={},ut=Object;ct=function(t){return ut(j(t))};var dt=b({}.hasOwnProperty);lt=Object.hasOwn||function(t,e){return dt(ct(t),e)};var ft,pt=0,mt=Math.random(),ht=b(1..toString);ft=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ht(++pt+mt,36)};var vt=rt("wks"),yt=i.Symbol,gt=yt&&yt.for,bt=H?yt:yt&&yt.withoutSetter||ft;nt=function(t){if(!lt(vt,t)||!M&&"string"!=typeof vt[t]){var e="Symbol."+t;M&&lt(yt,t)?vt[t]=yt[t]:vt[t]=H&&gt?gt(e):bt(e)}return vt[t]};var wt=TypeError,Et=nt("toPrimitive");T=function(t,e){if(!A(t)||I(t))return t;var n,r=Y(t,Et);if(r){if(void 0===e&&(e="default"),n=l(r,t,e),!A(n)||I(n))return n;throw wt("Can't convert object to primitive value")}return void 0===e&&(e="number"),tt(t,e)},R=function(t){var e=T(t,"string");return I(e)?e:e+""};var Pt,St,Ot=i.document,kt=A(Ot)&&A(Ot.createElement);St=function(t){return kt?Ot.createElement(t):{}},Pt=!o&&!s((function(){return 7!=Object.defineProperty(St("div"),"a",{get:function(){return 7}}).a}));var Ct,Lt,jt=Object.getOwnPropertyDescriptor,zt=n=o?jt:function(t,e){if(t=v(t),e=R(e),Pt)try{return jt(t,e)}catch(t){}if(lt(t,e))return h(!l(u,t,e),t[e])},Rt={};Lt=o&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}));var Tt,At=String,_t=TypeError;Tt=function(t){if(A(t))return t;throw _t(At(t)+" is not an object")};var xt=TypeError,It=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor;Ct=o?Lt?function(t,e,n){if(Tt(t),e=R(e),Tt(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=Dt(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return It(t,e,n)}:It:function(t,e,n){if(Tt(t),e=R(e),Tt(n),Pt)try{return It(t,e,n)}catch(t){}if("get"in n||"set"in n)throw xt("Accessors not supported");return"value"in n&&(t[e]=n.value),t},Rt=o?function(t,e,n){return Ct(t,e,h(1,n))}:function(t,e,n){return t[e]=n,t};var Ft,Ht,Mt,Nt=Function.prototype,Vt=o&&Object.getOwnPropertyDescriptor,Gt=lt(Nt,"name"),$t=(Mt={EXISTS:Gt,PROPER:Gt&&"something"===function(){}.name,CONFIGURABLE:Gt&&(!o||o&&Vt(Nt,"name").configurable)}).CONFIGURABLE,Ut={},Wt=b(Function.toString);_(at.inspectSource)||(at.inspectSource=function(t){return Wt(t)}),Ut=at.inspectSource;var Bt,qt,Kt=i.WeakMap;qt=_(Kt)&&/native code/.test(Ut(Kt));var Yt,Xt=rt("keys");Yt=function(t){return Xt[t]||(Xt[t]=ft(t))};var Jt={};Jt={};var Qt,Zt,te,ee=i.TypeError,ne=i.WeakMap;if(qt||at.state){var re=at.state||(at.state=new ne),ie=b(re.get),ae=b(re.has),oe=b(re.set);Qt=function(t,e){if(ae(re,t))throw new ee("Object already initialized");return e.facade=t,oe(re,t,e),e},Zt=function(t){return ie(re,t)||{}},te=function(t){return ae(re,t)}}else{var se=Yt("state");Jt[se]=!0,Qt=function(t,e){if(lt(t,se))throw new ee("Object already initialized");return e.facade=t,Rt(t,se,e),e},Zt=function(t){return lt(t,se)?t[se]:{}},te=function(t){return lt(t,se)}}var ce=(Bt={set:Qt,get:Zt,has:te,enforce:function(t){return te(t)?Zt(t):Qt(t,{})},getterFor:function(t){return function(e){var n;if(!A(e)||(n=Zt(e)).type!==t)throw ee("Incompatible receiver, "+t+" required");return n}}}).enforce,le=Bt.get,ue=Object.defineProperty,de=o&&!s((function(){return 8!==ue((function(){}),"length",{value:8}).length})),fe=String(String).split("String"),pe=Ht=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!lt(t,"name")||$t&&t.name!==e)&&ue(t,"name",{value:e,configurable:!0}),de&&n&&lt(n,"arity")&&t.length!==n.arity&&ue(t,"length",{value:n.arity});try{n&&lt(n,"constructor")&&n.constructor?o&&ue(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=ce(t);return lt(r,"source")||(r.source=fe.join("string"==typeof e?e:"")),t};Function.prototype.toString=pe((function(){return _(this)&&le(this).source||Ut(this)}),"toString"),Ft=function(t,e,n,r){r||(r={});var i=r.enumerable,a=void 0!==r.name?r.name:e;return _(n)&&Ht(n,a,r),r.global?i?t[e]=n:it(e,n):(r.unsafe?t[e]&&(i=!0):delete t[e],i?t[e]=n:Ct(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})),t};var me,he,ve,ye,ge,be={},we={},Ee=Math.ceil,Pe=Math.floor;we=Math.trunc||function(t){var e=+t;return(e>0?Pe:Ee)(e)},ge=function(t){var e=+t;return e!=e||0===e?0:we(e)};var Se=Math.max,Oe=Math.min;ye=function(t,e){var n=ge(t);return n<0?Se(n+e,0):Oe(n,e)};var ke,Ce,Le=Math.min;Ce=function(t){return t>0?Le(ge(t),9007199254740991):0},ke=function(t){return Ce(t.length)};var je=function(t){return function(e,n,r){var i,a=v(e),o=ke(a),s=ye(r,o);if(t&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((t||s in a)&&a[s]===n)return t||s||0;return!t&&-1}},ze={includes:je(!0),indexOf:je(!1)}.indexOf,Re=b([].push);ve=function(t,e){var n,r=v(t),i=0,a=[];for(n in r)!lt(Jt,n)&&lt(r,n)&&Re(a,n);for(;e.length>i;)lt(r,n=e[i++])&&(~ze(a,n)||Re(a,n));return a};var Te,Ae={},_e=(Ae=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]).concat("length","prototype");he=Object.getOwnPropertyNames||function(t){return ve(t,_e)},Te=Object.getOwnPropertySymbols;var xe=b([].concat);be=x("Reflect","ownKeys")||function(t){var e=he(Tt(t));return Te?xe(e,Te(t)):e},me=function(t,e,r){for(var i=be(e),a=Ct,o=n,s=0;s<i.length;s++){var c=i[s];lt(t,c)||r&&lt(r,c)||a(t,c,o(e,c))}};var Ie={},De=/#|\.prototype\./,Fe=function(t,e){var n=Me[He(t)];return n==Ve||n!=Ne&&(_(e)?s(e):!!e)},He=Fe.normalize=function(t){return String(t).replace(De,".").toLowerCase()},Me=Fe.data={},Ne=Fe.NATIVE="N",Ve=Fe.POLYFILL="P";Ie=Fe,e=function(t,e){var n,r,a,o,s,c=t.target,l=t.global,u=t.stat;if(n=l?i:u?i[c]||it(c,{}):(i[c]||{}).prototype)for(r in e){if(o=e[r],a=t.dontCallGetSet?(s=zt(n,r))&&s.value:n[r],!Ie(l?r:c+(u?".":"#")+r,t.forced)&&void 0!==a){if(typeof o==typeof a)continue;me(o,a)}(t.sham||a&&a.sham)&&Rt(o,"sham",!0),Ft(n,r,o,t)}};var Ge;Ge=i.Promise;var $e,Ue,We,Be={},qe={},Ke={};Ke[nt("toStringTag")]="z",We="[object z]"===String(Ke);var Ye=nt("toStringTag"),Xe=Object,Je="Arguments"==y(function(){return arguments}());qe=We?y:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Xe(t),Ye))?n:Je?y(e):"Object"==(r=y(e))&&_(e.callee)?"Arguments":r};var Qe=function(){},Ze=[],tn=x("Reflect","construct"),en=/^\s*(?:class|function)\b/,nn=b(en.exec),rn=!en.exec(Qe),an=function(t){if(!_(t))return!1;try{return tn(Qe,Ze,t),!0}catch(t){return!1}},on=function(t){if(!_(t))return!1;switch(qe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rn||!!nn(en,Ut(t))}catch(t){return!0}};on.sham=!0,Be=!tn||s((function(){var t;return an(an.call)||!an(Object)||!an((function(){t=!0}))||t}))?on:an;var sn=TypeError;Ue=function(t){if(Be(t))return t;throw sn(J(t)+" is not a constructor")};var cn=nt("species");$e=function(t,e){var n,r=Tt(t).constructor;return void 0===r||null==(n=Tt(r)[cn])?e:Ue(n)};var ln,un,dn=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=X(e),this.reject=X(n)};un=function(t){return new dn(t)},ln=function(t,e){if(Tt(t),A(e)&&e.constructor===t)return e;var n=un(t);return(0,n.resolve)(e),n.promise};var fn=Ge&&Ge.prototype,pn=!!Ge&&s((function(){fn.finally.call({then:function(){}},(function(){}))}));if(e({target:"Promise",proto:!0,real:!0,forced:pn},{finally:function(t){var e=$e(this,x("Promise")),n=_(t);return this.then(n?function(n){return ln(e,t()).then((function(){return n}))}:t,n?function(n){return ln(e,t()).then((function(){throw n}))}:t)}}),_(Ge)){var mn=x("Promise").prototype.finally;fn.finally!==mn&&Ft(fn,"finally",mn,{unsafe:!0})}var hn;hn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};var vn,yn=St("span").classList,gn=yn&&yn.constructor&&yn.constructor.prototype;vn=gn===Object.prototype?void 0:gn;var bn,wn,En,Pn={},Sn={};Sn=Object.keys||function(t){return ve(t,Ae)},En=o&&!Lt?Object.defineProperties:function(t,e){Tt(t);for(var n,r=v(e),i=Sn(e),a=i.length,o=0;a>o;)Ct(t,n=i[o++],r[n]);return t};var On={};On=x("document","documentElement");var kn,Cn=Yt("IE_PROTO"),Ln=function(){},jn=function(t){return"<script>"+t+"<\/script>"},zn=function(t){t.write(jn("")),t.close();var e=t.parentWindow.Object;return t=null,e},Rn=function(){try{kn=new ActiveXObject("htmlfile")}catch(t){}var t,e;Rn="undefined"!=typeof document?document.domain&&kn?zn(kn):((e=St("iframe")).style.display="none",On.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(jn("document.F=Object")),t.close(),t.F):zn(kn);for(var n=Ae.length;n--;)delete Rn.prototype[Ae[n]];return Rn()};Jt[Cn]=!0,Pn=Object.create||function(t,e){var n;return null!==t?(Ln.prototype=Tt(t),n=new Ln,Ln.prototype=null,n[Cn]=t):n=Rn(),void 0===e?n:En(n,e)};var Tn=Ct,An=nt("unscopables"),_n=Array.prototype;null==_n[An]&&Tn(_n,An,{configurable:!0,value:Pn(null)}),wn=function(t){_n[An][t]=!0};var xn={};xn={};var In,Dn,Fn,Hn,Mn=Ct,Nn={};Hn=!s((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}));var Vn=Yt("IE_PROTO"),Gn=Object,$n=Gn.prototype;Nn=Hn?Gn.getPrototypeOf:function(t){var e=ct(t);if(lt(e,Vn))return e[Vn];var n=e.constructor;return _(n)&&e instanceof n?n.prototype:e instanceof Gn?$n:null};var Un,Wn,Bn,qn=nt("iterator"),Kn=!1;[].keys&&("next"in(Bn=[].keys())?(Wn=Nn(Nn(Bn)))!==Object.prototype&&(Un=Wn):Kn=!0),(null==Un||s((function(){var t={};return Un[qn].call(t)!==t})))&&(Un={}),_(Un[qn])||Ft(Un,qn,(function(){return this}));var Yn,Xn=(Fn={IteratorPrototype:Un,BUGGY_SAFARI_ITERATORS:Kn}).IteratorPrototype,Jn=Ct,Qn=nt("toStringTag");Yn=function(t,e,n){t&&!n&&(t=t.prototype),t&&!lt(t,Qn)&&Jn(t,Qn,{configurable:!0,value:e})};var Zn=function(){return this};Dn=function(t,e,n,r){var i=e+" Iterator";return t.prototype=Pn(Xn,{next:h(+!r,n)}),Yn(t,i,!1),xn[i]=Zn,t};var tr,er={},nr=String,rr=TypeError;tr=function(t){if("object"==typeof t||_(t))return t;throw rr("Can't set "+nr(t)+" as a prototype")},er=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=b(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Tt(n),tr(r),e?t(n,r):n.__proto__=r,n}}():void 0);var ir=Mt.PROPER,ar=Mt.CONFIGURABLE,or=Fn.IteratorPrototype,sr=Fn.BUGGY_SAFARI_ITERATORS,cr=nt("iterator"),lr=function(){return this};In=function(t,n,r,i,a,o,s){Dn(r,n,i);var c,u,d,f=function(t){if(t===a&&y)return y;if(!sr&&t in h)return h[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},p=n+" Iterator",m=!1,h=t.prototype,v=h[cr]||h["@@iterator"]||a&&h[a],y=!sr&&v||f(a),g="Array"==n&&h.entries||v;if(g&&(c=Nn(g.call(new t)))!==Object.prototype&&c.next&&(Nn(c)!==or&&(er?er(c,or):_(c[cr])||Ft(c,cr,lr)),Yn(c,p,!0)),ir&&"values"==a&&v&&"values"!==v.name&&(ar?Rt(h,"name","values"):(m=!0,y=function(){return l(v,this)})),a)if(u={values:f("values"),keys:o?y:f("keys"),entries:f("entries")},s)for(d in u)(sr||m||!(d in h))&&Ft(h,d,u[d]);else e({target:n,proto:!0,forced:sr||m},u);return h[cr]!==y&&Ft(h,cr,y,{name:a}),xn[n]=y,u};var ur=Bt.set,dr=Bt.getterFor("Array Iterator");bn=In(Array,"Array",(function(t,e){ur(this,{type:"Array Iterator",target:v(t),index:0,kind:e})}),(function(){var t=dr(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values");var fr=xn.Arguments=xn.Array;if(wn("keys"),wn("values"),wn("entries"),o&&"values"!==fr.name)try{Mn(fr,"name",{value:"values"})}catch(t){}var pr=nt("iterator"),mr=nt("toStringTag"),hr=bn.values,vr=function(t,e){if(t){if(t[pr]!==hr)try{Rt(t,pr,hr)}catch(e){t[pr]=hr}if(t[mr]||Rt(t,mr,e),hn[e])for(var n in bn)if(t[n]!==bn[n])try{Rt(t,n,bn[n])}catch(e){t[n]=bn[n]}}};for(var yr in hn)vr(i[yr]&&i[yr].prototype,yr);vr(vn,"DOMTokenList");class gr{buildExecutor(t){const e=this.unpack(t);return()=>this.execute(e)}constructor(t){this.state=t}}function br(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class wr{preload(t,e){const n=t.split("/",1)[0],r=this.typeRegistry.get(n);return!!r&&(r(e),!0)}preloadImage(t){const{href:e}=new URL(t),n=new Image;n.src=e,this.refs.set(e,n)}preloadVideo(t){const{href:e}=new URL(t),n=document.createElement("video");n.preload="auto",n.src=e,this.refs.set(e,n)}unref(...t){0===t.length?this.refs.clear():t.forEach((t=>this.refs.delete(t)))}constructor(){br(this,"refs",new Map),br(this,"typeRegistry",new Map),this.typeRegistry.set("image",this.preloadImage.bind(this)),this.typeRegistry.set("video",this.preloadVideo.bind(this))}}class Er extends gr{async execute(t){return this.preloader.unref(),t.forEach((({mimetype:t,url:e})=>this.preloader.preload(t,e))),Promise.resolve()}unpack(t){if(!Array.isArray(t))throw new TypeError("PreloadAction.unpack(arg): arg must be an array");return t.forEach(((t,e)=>{const{mimetype:n,url:r}=t;if("string"!=typeof n)throw new TypeError(`PreloadAction.unpack(arg): item ${e} of args must have a mimetype`);if("string"!=typeof r)throw new TypeError(`PreloadAction.unpack(arg): item ${e} of arg must have an url`)})),t}constructor(t){super(t),this.preloader=new wr}}let Pr;!function(t){t[t.OFF=0]="OFF",t[t.ERROR=200]="ERROR",t[t.WARN=300]="WARN",t[t.INFO=400]="INFO",t[t.DEBUG=500]="DEBUG",t[t.TRACE=600]="TRACE"}(Pr||(Pr={}));class Sr{error(...t){this.level>=Pr.ERROR&&console.error(...t)}assert(t,...e){this.level>=Pr.ERROR&&console.assert(t,...e)}warn(...t){this.level>=Pr.WARN&&console.warn(...t)}info(...t){this.level>=Pr.INFO&&console.info(...t)}debug(...t){this.level>=Pr.DEBUG&&console.debug(...t)}trace(...t){this.level>=Pr.TRACE&&console.trace(...t)}constructor(t=Pr.INFO){this.level=t}}class Or extends gr{async execute(){return window.location.reload(),Promise.resolve()}unpack(){}constructor(t){super(t)}}class kr{static create(t,e,n="cover"){let r;switch(t.split("/",1)[0]){case"image":r=kr.createImage(e);break;case"video":r=kr.createVideo(e);break;default:r=kr.createObject(t,e)}return r.classList.add("content"),r.classList.add(`fit-${n}`),r}static createObject(t,e){const n=document.createElement("object");return n.type=t,n.data=e,n}static createImage(t){const e=document.createElement("img");return e.src=t,e}static createVideo(t){const e=document.createElement("video");return e.preload="auto",e.src=t,e.autoplay=!1,e}static async awaitLoad(t){return new Promise((e=>{if("IMG"===t.tagName){const n=t;if(n.complete)e(t);else{const r=()=>{n.removeEventListener("load",r),n.removeEventListener("error",r),requestAnimationFrame((()=>e(t)))};n.addEventListener("load",r),n.addEventListener("error",r)}}else setTimeout((()=>e(t)),1e3)}))}static play(t){if("VIDEO"===t.tagName){t.play().finally((()=>{}))}}}class Cr{promise(){return this._promise}resolve(t){return this._resolve(t)}reject(){return this._reject()}constructor(){let t=t=>{},e=()=>{};this._promise=new Promise(((n,r)=>{t=n,e=r})),this._resolve=t,this._reject=e}}class Lr{isCancelled(){return this._isCancelled}targetVisible(){return this.targetVisiblePEC.promise()}done(){return this.donePEC.promise()}isDone(){return this._isDone}constructor(t,e,n){br(this,"_isCancelled",!1),br(this,"_isDone",!1),this.container=t,this.from=e,this.to=n,this.targetVisiblePEC=new Cr,this.donePEC=new Cr,this.targetVisiblePEC.promise().catch((()=>{})),this.donePEC.promise().catch((()=>{}))}}class jr extends Lr{cancel(){}targetVisible(){return Promise.resolve()}done(){return Promise.resolve()}static unpack(){}static prepare(){return(t,e,n)=>new jr(t,e,n)}static getStyleSheetAsString(){return""}constructor(t=document.createElement("div"),e=document.createElement("div"),n=document.createElement("div")){super(t,e,n),this._isCancelled=!1,this._isDone=!0}}const zr={duration:500,color:"#000"};class Rr extends Lr{end(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isDone=!0,this.targetVisiblePEC.resolve(),this.donePEC.resolve())}cancel(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isCancelled=!0,this.targetVisiblePEC.resolve(),this.donePEC.reject())}cleanup(){this.from.removeEventListener("animationend",this.fromEndCancelHandler),this.from.removeEventListener("animationcancel",this.fromEndCancelHandler),this.to.removeEventListener("animationend",this.toEndHandler),this.to.removeEventListener("animationcancel",this.toCancelHandler);const{style:t}=this.container;t.removeProperty("--transition-fade-duration"),t.removeProperty("--transition-fade-color"),this.from.classList.remove("fade"),this.from.classList.remove("fade-out"),this.to.classList.remove("fade"),this.to.classList.remove("fade-in")}static unpack(t){return t}static prepare(t){const e=Rr.unpack(t);return(t,n,r)=>new Rr(t,n,r,e)}static getStyleSheetAsString(){return t("@-webkit-keyframes transition-fade-out{0%{opacity:1}to{opacity:0}}@keyframes transition-fade-out{0%{opacity:1}to{opacity:0}}@-webkit-keyframes transition-fade-in{0%{opacity:0}to{opacity:1}}@keyframes transition-fade-in{0%{opacity:0}to{opacity:1}}.container{--transition-fade-color:black;--transition-fade-duration:1s;--transition-fade-duration-half:calc(var(--transition-fade-duration)/2);background-color:var(--transition-fade-color)}.container>.transition.fade{-webkit-animation-duration:var(--transition-fade-duration-half);-webkit-animation-duration:var(--transition-fade-duration-half);animation-duration:var(--transition-fade-duration-half);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}.container>.transition.fade.fade-out{-webkit-animation-name:transition-fade-out;animation-name:transition-fade-out}.container>.transition.fade.fade-in{-webkit-animation-name:transition-fade-in;animation-name:transition-fade-in;-webkit-animation-delay:var(--transition-fade-duration-half);-webkit-animation-delay:var(--transition-fade-duration-half);animation-delay:var(--transition-fade-duration-half)}")}constructor(t,e,n,r){super(t,e,n);const{duration:i,color:a}={...zr,...null!=r?r:{}},{style:o}=t;o.setProperty("--transition-fade-duration",`${i}s`),o.setProperty("--transition-fade-color",`${a}`),e.classList.add("fade"),e.classList.add("fade-out"),this.fromEndCancelHandler=({animationName:t})=>{"transition-fade-out"===t&&this.targetVisiblePEC.resolve()},e.addEventListener("animationend",this.fromEndCancelHandler),e.addEventListener("animationcancel",this.fromEndCancelHandler),n.classList.add("fade"),n.classList.add("fade-in"),this.toEndHandler=({animationName:t})=>{"transition-fade-in"===t&&this.end()},this.toCancelHandler=({animationName:t})=>{"transition-fade-in"===t&&this.cancel()},n.addEventListener("animationend",this.toEndHandler),n.addEventListener("animationcancel",this.toCancelHandler)}}const Tr={duration:500};class Ar extends Lr{end(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isDone=!0,this.donePEC.resolve())}cancel(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isCancelled=!0,this.donePEC.reject())}cleanup(){this.to.removeEventListener("animationend",this.toEndHandler),this.to.removeEventListener("animationcancel",this.toCancelHandler);const{style:t}=this.container;t.removeProperty("--transition-cross-fade-duration"),this.from.classList.remove("cross-fade"),this.from.classList.remove("cross-fade-out"),this.to.classList.remove("cross-fade"),this.to.classList.remove("cross-fade-in")}static unpack(t){return t}static prepare(t){const e=Ar.unpack(t);return(t,n,r)=>new Ar(t,n,r,e)}static getStyleSheetAsString(){return t("@-webkit-keyframes transition-cross-fade-in{0%{opacity:0}to{opacity:1}}@keyframes transition-cross-fade-in{0%{opacity:0}to{opacity:1}}.container{--transition-cross-fade-duration:1s}.container>.transition.cross-fade.cross-fade-in{-webkit-animation-duration:var(--transition-cross-fade-duration);-webkit-animation-duration:var(--transition-cross-fade-duration);animation-duration:var(--transition-cross-fade-duration);-webkit-animation-name:transition-cross-fade-in;animation-name:transition-cross-fade-in;-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}")}constructor(t,e,n,r){super(t,e,n);const{duration:i}={...Tr,...null!=r?r:{}},{style:a}=t;a.setProperty("--transition-cross-fade-duration",`${i}s`),e.classList.add("cross-fade"),e.classList.add("cross-fade-out"),n.classList.add("cross-fade"),n.classList.add("cross-fade-in"),this.toEndHandler=({animationName:t})=>{"transition-cross-fade-in"===t&&this.end()},this.toCancelHandler=({animationName:t})=>{"transition-cross-fade-in"===t&&this.cancel()},n.addEventListener("animationend",this.toEndHandler),n.addEventListener("animationcancel",this.toCancelHandler),this.targetVisiblePEC.resolve()}}function _r(t,e,n){const r=document.createElement("style");void 0!==n&&(r.id=n),r.textContent=e;const i=t.querySelector("style[type='text/css']:last-of-type, style:not([type]):last-of-type");null===i?t.prepend(r):i.after(r)}class xr{registerKnownTransitions(){this.register("none",jr),this.register("fade",Rr),this.register("cross-fade",Ar)}register(t,e){if(this.transitionRegistry.has(t))throw new Error("Transition type already registered");_r(this.root,e.getStyleSheetAsString(),`transition-${t}`),this.transitionRegistry.set(t,e)}prepare(t="none",e={}){const n=this.transitionRegistry.get(t);if(!n)throw new Error(`Unknown transition type: ${t}`);return n.prepare(e)}constructor(t){br(this,"transitionRegistry",new Map),this.root=t,this.registerKnownTransitions()}}class Ir{isCancelled(){return this._isCancelled}done(){return this.donePEC.promise()}isDone(){return this._isDone}constructor(t,e){br(this,"_isCancelled",!1),br(this,"_isDone",!1),this.wrapper=t,this.content=e,this.donePEC=new Cr,this.donePEC.promise().catch((()=>{}))}}class Dr extends Ir{cancel(){}targetVisible(){return Promise.resolve()}done(){return Promise.resolve()}static unpack(){}static prepare(){return(t,e)=>new Dr(t,e)}static getStyleSheetAsString(){return""}constructor(t=document.createElement("div"),e=document.createElement("div")){super(t,e),this._isCancelled=!1,this._isDone=!0}}function Fr(t,e,n,r){void 0!==r&&t.style.setProperty(e,n(r))}class Hr extends Ir{async asyncInit(t){if(this.wrapper.classList.add("animation-pan-zoom"),void 0!==t.from)try{const{from:e}=t;this.setDefinedCssProperties(0,e),await new Promise((t=>{requestAnimationFrame(t)}))}catch(t){}if(!this.isCancelled()){const{duration:e,to:n}=t;this.setDefinedCssProperties(e,n),this.endHandler=({animationName:t})=>{"animation-pan-zoom-animation"===t&&this.end()},this.cancelHandler=({animationName:t})=>{"animation-pan-zoom-animation"===t&&this.cancel()},this.wrapper.addEventListener("animationend",this.endHandler),this.wrapper.addEventListener("animationcancel",this.cancelHandler)}}setDefinedCssProperties(t,{x:e,y:n,scale:r}){const{wrapper:i}=this,a=Fr;a(i,"--animation-pan-zoom-duration",(t=>`${t}s`),t),a(i,"--animation-pan-zoom-target-x",(t=>`${t}`),e),a(i,"--animation-pan-zoom-target-y",(t=>`${t}`),n),a(i,"--animation-pan-zoom-target-scale",(t=>`${t}`),r)}end(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isDone=!0,this.donePEC.resolve())}cancel(){this.isCancelled()||this.isDone()||(this.cleanup(),this._isCancelled=!0,this.donePEC.reject())}cleanup(){const{wrapper:t}=this;t.addEventListener("animationend",this.endHandler),t.addEventListener("animationcancel",this.cancelHandler)}static unpack(t){return t}static prepare(t){const e=Hr.unpack(t);return(t,n)=>new Hr(t,n,e)}static getStyleSheetAsString(){return t("@-webkit-keyframes animation-pan-zoom-animation{0%{top:0;left:0}to{top:calc(50% - 50%*var(--animation-pan-zoom-target-scale));left:calc(50% - 50%*var(--animation-pan-zoom-target-scale))}}@keyframes animation-pan-zoom-animation{0%{top:0;left:0}to{top:calc(50% - 50%*var(--animation-pan-zoom-target-scale));left:calc(50% - 50%*var(--animation-pan-zoom-target-scale))}}@-webkit-keyframes animation-pan-zoom-content{0%{width:100%;height:100%;object-position:50% 50%;top:0;left:0}to{left:calc(100%*var(--animation-pan-zoom-target-scale)*(.5 - var(--animation-pan-zoom-target-x)));top:calc(100%*var(--animation-pan-zoom-target-scale)*(.5 - var(--animation-pan-zoom-target-y)));width:calc(100%*var(--animation-pan-zoom-target-scale));height:calc(100%*var(--animation-pan-zoom-target-scale));object-position:calc(100%*var(--animation-pan-zoom-target-x))calc(100%*var(--animation-pan-zoom-target-y))}}@keyframes animation-pan-zoom-content{0%{width:100%;height:100%;object-position:50% 50%;top:0;left:0}to{left:calc(100%*var(--animation-pan-zoom-target-scale)*(.5 - var(--animation-pan-zoom-target-x)));top:calc(100%*var(--animation-pan-zoom-target-scale)*(.5 - var(--animation-pan-zoom-target-y)));width:calc(100%*var(--animation-pan-zoom-target-scale));height:calc(100%*var(--animation-pan-zoom-target-scale));object-position:calc(100%*var(--animation-pan-zoom-target-x))calc(100%*var(--animation-pan-zoom-target-y))}}.container>.transition>.animation.animation-pan-zoom{--animation-pan-zoom-duration:0s;--animation-pan-zoom-target-x:.5;--animation-pan-zoom-target-y:.5;--animation-pan-zoom-target-scale:1;-webkit-animation-name:animation-pan-zoom-animation;animation-name:animation-pan-zoom-animation}.container>.transition>.animation.animation-pan-zoom,.container>.transition>.animation.animation-pan-zoom>*{-webkit-animation-duration:var(--animation-pan-zoom-duration);-webkit-animation-duration:var(--animation-pan-zoom-duration);animation-duration:var(--animation-pan-zoom-duration);-webkit-animation-timing-function:ease-in-out;animation-timing-function:ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both}.container>.transition>.animation.animation-pan-zoom>*{-webkit-animation-name:animation-pan-zoom-content;animation-name:animation-pan-zoom-content;position:relative}.sdfdsf-resizable>div{--zoom-factor:1;--pan-target-x:.5;--pan-target-y:.5;--transition-duration:10s;width:100%;height:100%;top:calc(50% - 50%*var(--zoom-factor));left:calc(50% - 50%*var(--zoom-factor));z-index:-1;transition-property:top,left,width,height;position:relative}.sdfdsf-resizable>div,.sdfdsf-resizable>div *{transition-duration:var(--transition-duration)}.sdfdsf-resizable>div img{left:calc(100%*var(--zoom-factor)*(.5 - var(--pan-target-x)));top:calc(100%*var(--zoom-factor)*(.5 - var(--pan-target-y)));width:calc(100%*var(--zoom-factor));height:calc(100%*var(--zoom-factor));object-fit:cover;object-position:calc(100%*var(--pan-target-x))calc(100%*var(--pan-target-y));transition-property:top,left,width,height,object-position;position:relative}")}constructor(t,e,n){super(t,e),this.endHandler=()=>{},this.cancelHandler=()=>{},this.asyncInit(n).finally((()=>{}))}}class Mr{registerKnownTransitions(){this.register("none",Dr),this.register("pan-zoom",Hr)}register(t,e){if(this.animationRegistry.has(t))throw new Error("Animation type already registered");_r(this.root,e.getStyleSheetAsString(),`animation-${t}`),this.animationRegistry.set(t,e)}prepare(t="none",e={}){const n=this.animationRegistry.get(t);if(!n)throw new Error(`Unknown animation type: ${t}`);return n.prepare(e)}constructor(t){br(this,"animationRegistry",new Map),this.root=t,this.registerKnownTransitions()}}class Nr extends gr{removePrevious(){const{container:t}=this.state;for(;t.children.length>1;)t.children[0].remove()}cleanup(){this.transition.cancel(),this.animation.cancel(),this.removePrevious()}appendCurrentContent(t,e){const n=document.createElement("div");n.classList.add("animation"),n.appendChild(t);const r=document.createElement("div");r.classList.add("transition"),r.style.setProperty("--transition-background-color",e),r.appendChild(n);const{container:i}=this.state;return i.appendChild(r),{transition:r,animation:n,content:t}}async execute(t){const{mimetype:e,url:n,fit:r,color:i}=t,a=this.prepareTransition(t),o=this.prepareAnimation(t),s=kr.create(e,n,r);try{await kr.awaitLoad(s)}catch(t){this.state.log.warn("Waiting for content to load failed. Proceeding anyway.")}this.cleanup();const c=this.current;this.current=this.appendCurrentContent(s,null!=i?i:"black"),this.transition=this.createTransition(a,c);try{await this.transition.targetVisible()}catch(t){this.state.log.warn("Waiting for target to become visible failed. Proceeding anyway.")}kr.play(s),this.animation=this.createAnimation(o);try{await this.transition.done()}catch(t){const e="Waiting for transition to end failed. Proceeding anyway";t?this.state.log.warn(e,t):this.state.log.warn(e)}this.removePrevious()}prepareTransition(t){const{transition:e}=t,{type:n,options:r}=null!=e?e:{type:"none",options:{}};return this.transitionFactory.prepare(n,r)}prepareAnimation(t){const{animation:e}=t,{type:n,options:r}=null!=e?e:{type:"none",options:{}};return this.animationFactory.prepare(n,r)}createTransition(t,e){const{container:n}=this.state;return t(n,e.transition,this.current.transition)}createAnimation(t){const{animation:e,content:n}=this.current;return t(e,n)}unpack(t){if("object"!=typeof t)throw new TypeError("ShowAction.unpack(arg): arg must be an object");return t}constructor(t){super(t),this.transitionFactory=new xr(t.shadowRoot),this.animationFactory=new Mr(t.shadowRoot),this.transition=new jr,this.animation=new Dr;const e=document.createElement("div");this.current=this.appendCurrentContent(e,"black")}}class Vr extends HTMLElement{createActionRegistry(){const t=new Map;return t.set("reload",new Or(this.state)),t.set("preload",new Er(this.state)),t.set("show",new Nr(this.state)),t}async execute(t,e){await this.executeImpl(t,e)}async executeImpl(t,e){const n=this.actionRegistry.get(t);if(!n)throw new TypeError("HilbertGalleryViewer.execute(): unknown action");{const t=n.buildExecutor(e);await t()}}constructor(){super();const e=this.attachShadow({mode:"open"});_r(e,t(":host{width:100%;height:100%;position:relative}:host>.container{width:100%;height:100%;position:relative}:host>.container>.transition{--transition-background-color:black;background-color:var(--transition-background-color);width:100%;height:100%;position:absolute}:host>.container>.transition>.animation,:host>.container>.transition>.animation>.content{width:100%;height:100%;position:relative}:host>.container>.transition>.animation>.content.fit-contain{object-fit:contain}:host>.container>.transition>.animation>.content.fit-cover{object-fit:cover}"));const n=document.createElement("div");n.classList.add("container"),e.appendChild(n),this.state={log:new Sr(Pr.WARN),shadowRoot:e,container:n},this.actionRegistry=this.createActionRegistry()}}customElements.define("hilbert-gallery-viewer",Vr);
//# sourceMappingURL=hilbert-gallery-viewer.min.mjs.map
